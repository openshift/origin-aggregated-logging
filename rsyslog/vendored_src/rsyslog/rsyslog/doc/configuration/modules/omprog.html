
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>omprog: Program integration Output module &#8212; rsyslog 8.37.0 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/rsyslog.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '8.37.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="omrelp: RELP Output Module" href="omrelp.html" />
    <link rel="prev" title="ompipe: Pipe Output Module" href="ompipe.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="omrelp.html" title="omrelp: RELP Output Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ompipe.html" title="ompipe: Pipe Output Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">rsyslog 8.37.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Configuration</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Modules</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="idx_output.html" accesskey="U">Output Modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="omprog-program-integration-output-module">
<h1>omprog: Program integration Output module<a class="headerlink" href="#omprog-program-integration-output-module" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Module Name:</strong></td>
<td><strong>omprog</strong></td>
</tr>
<tr class="row-even"><td><strong>Author:</strong></td>
<td><a class="reference external" href="https://rainer.gerhards.net/">Rainer Gerhards</a> &lt;<a class="reference external" href="mailto:rgerhards&#37;&#52;&#48;adiscon&#46;com">rgerhards<span>&#64;</span>adiscon<span>&#46;</span>com</a>&gt;</td>
</tr>
</tbody>
</table>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>This module permits to integrate arbitrary external programs into
rsyslog’s logging. It is similar to the “execute program (^)” action,
but offers better security and much higher performance. While “execute
program (^)” can be a useful tool for executing programs if rare events
occur, omprog can be used to provide massive amounts of log data to a
program.</p>
<p>Executes the configured program and feeds log messages to that binary
via stdin. The binary is free to do whatever it wants with the supplied
data. If the program terminates, it is re-started. If rsyslog
terminates, the program’s stdin will see EOF. The program must then
terminate. The message format passed to the program can, as usual, be
modified by defining rsyslog templates.</p>
<p>Note that in order to execute the given program, rsyslog needs to have
sufficient permissions on the binary file. This is especially true if
not running as root. Also, keep in mind that default SELinux policies
most probably do not permit rsyslogd to execute arbitrary binaries. As
such, permissions must be appropriately added. Note that SELinux
restrictions also apply if rsyslogd runs under root. To check if a
problem is SELinux-related, you can temporarily disable SELinux and
retry. If it then works, you know for sure you have a SELinux issue.</p>
<p>Starting with 8.4.0, rsyslogd emits an error message via the <code class="docutils literal"><span class="pre">syslog()</span></code>
API call when there is a problem executing the binary. This can be
extremely valuable in troubleshooting. For those technically savy:
when we execute a binary, we need to fork, and we do not have
full access to rsyslog’s usual error-reporting capabilities after the
fork. As the actual execution must happen after the fork, we cannot
use the default error logger to emit the error message. As such,
we use <code class="docutils literal"><span class="pre">syslog()</span></code>. In most cases, there is no real difference
between both methods. However, if you run multiple rsyslog instances,
the message shows up in that instance that processes the default
log socket, which may be different from the one where the error occured.
Also, if you redirected the log destination, that redirection may
not work as expected.</p>
</div>
<div class="section" id="configuration-parameters">
<h2>Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Parameter names are case-insensitive.</p>
</div>
<div class="section" id="action-parameters">
<h3>Action Parameters<a class="headerlink" href="#action-parameters" title="Permalink to this headline">¶</a></h3>
<div class="section" id="template">
<h4>template<a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>word</td>
<td>RSYSLOG_FileFormat</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Name of the <a class="reference internal" href="../templates.html"><span class="doc">template</span></a> to use to format the log messages
passed to the external program.</p>
</div>
<div class="section" id="binary">
<h4>binary<a class="headerlink" href="#binary" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>&#160;</td>
<td>yes</td>
<td><code class="docutils literal"><span class="pre">$ActionOMProgBinary</span></code></td>
</tr>
</tbody>
</table>
<p>Full path and command line parameters of the external program to execute.</p>
<p>In legacy config, it is <strong>not possible</strong> to specify command line parameters.</p>
</div>
<div class="section" id="confirmmessages">
<span id="id1"></span><h4>confirmMessages<a class="headerlink" href="#confirmmessages" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.31.0.</span></p>
</div>
<p>Specifies whether the external program provides feedback to rsyslog via stdout.
When this switch is set to “on”, rsyslog will wait for the program to confirm
each received message. This feature facilitates error handling: instead of
having to implement a retry logic, the external program can rely on the rsyslog
queueing capabilities.</p>
<p>To confirm a message, the program must write a line with the word <code class="docutils literal"><span class="pre">OK</span></code> to its
standard output. If it writes a line containing anything else, rsyslog considers
that the message could not be processed, keeps it in the action queue, and
re-sends it to the program later (after the period specified by the
<a class="reference internal" href="../actions.html"><span class="doc">action.resumeInterval</span></a> parameter).</p>
<p>In addition, when a new instance of the program is started, rsyslog will also
wait for the program to confirm it is ready to start consuming logs. This
prevents rsyslog from starting to send logs to a program that could not
complete its initialization properly.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://github.com/rsyslog/rsyslog/blob/master/plugins/external/INTERFACE.md">Interface between rsyslog and external output plugins</a></p>
</div>
</div>
<div class="section" id="usetransactions">
<span id="id2"></span><h4>useTransactions<a class="headerlink" href="#usetransactions" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.31.0.</span></p>
</div>
<p>Specifies whether the external program processes the messages in
<a class="reference internal" href="../../development/dev_oplugins.html"><span class="doc">batches</span></a> (transactions). When this
switch is enabled, the logs sent to the program are grouped in transactions.
At the start of a transaction, rsyslog sends a special mark message to the
program (see <a class="reference internal" href="#begintransactionmark">beginTransactionMark</a>). At the end of the transaction, rsyslog
sends another mark message (see <a class="reference internal" href="#committransactionmark">commitTransactionMark</a>).</p>
<p>If <a class="reference internal" href="#confirmmessages">confirmMessages</a> is also set to “on”, the program must confirm both the
mark messages and the logs within the transaction. The mark messages must be
confirmed by returning <code class="docutils literal"><span class="pre">OK</span></code>, and the individual messages by returning
<code class="docutils literal"><span class="pre">DEFER_COMMIT</span></code> (instead of <code class="docutils literal"><span class="pre">OK</span></code>). Refer to the link below for details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://github.com/rsyslog/rsyslog/blob/master/plugins/external/INTERFACE.md">Interface between rsyslog and external output plugins</a></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">There is currently a <a class="reference external" href="https://github.com/rsyslog/rsyslog/issues/2420">known issue</a> with the use of
transactions together with <code class="docutils literal"><span class="pre">confirmMessages=on</span></code>.</p>
</div>
</div>
<div class="section" id="begintransactionmark">
<span id="id4"></span><h4>beginTransactionMark<a class="headerlink" href="#begintransactionmark" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>BEGIN TRANSACTION</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.31.0.</span></p>
</div>
<p>Allows specifying the mark message that rsyslog will send to the external
program to indicate the start of a transaction (batch). This parameter is
ignored if <a class="reference internal" href="#usetransactions">useTransactions</a> is disabled.</p>
</div>
<div class="section" id="committransactionmark">
<span id="id5"></span><h4>commitTransactionMark<a class="headerlink" href="#committransactionmark" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>COMMIT TRANSACTION</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.31.0.</span></p>
</div>
<p>Allows specifying the mark message that rsyslog will send to the external
program to indicate the end of a transaction (batch). This parameter is
ignored if <a class="reference internal" href="#usetransactions">useTransactions</a> is disabled.</p>
</div>
<div class="section" id="output">
<span id="id6"></span><h4>output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>none</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version v8.1.6.</span></p>
</div>
<p>Full path of a file where the output of the external program must be saved,
for debugging purposes.</p>
<p>Note that if the action has multiple worker threads
(<a class="reference internal" href="../../rainerscript/queue_parameters.html"><span class="doc">queue.workerThreads</span></a> is
set to a value greater than 1), all threads will write to the file at the
same time, which will cause the output of the multiple child processes to be
mixed. When using this parameter, use a single worker thread.</p>
<p>If <a class="reference internal" href="#confirmmessages">confirmMessages</a> is set to “off” (the default), both the stdout and
stderr of the child process are written to the specified file.</p>
<p>If <a class="reference internal" href="#confirmmessages">confirmMessages</a> is set to “on”, only the stderr of the child is
written to the specified file (since stdout is used for confirming the
messages).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">There is currently a known issue with omprog when this parameter is NOT
used: the stderr of the program will be assigned arbitrarily, or closed,
which can produce unpredictable results if the program emits something
to stderr (<a class="reference external" href="https://github.com/rsyslog/rsyslog/issues/2787">example</a>).
As a workaround, it is recommended to explicitly redirect stderr within
the program, or to use this parameter. In future versions, omprog will
execute the program with stderr redirected to /dev/null when this
parameter is not specified. The same considerations apply to stdout
when <a class="reference internal" href="#confirmmessages">confirmMessages</a> is set to “off”.</p>
</div>
</div>
<div class="section" id="hup-signal">
<h4>hup.signal<a class="headerlink" href="#hup-signal" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>word</td>
<td>none</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.9.0.</span></p>
</div>
<p>Specifies which signal, if any, is to be forwarded to the external program
when rsyslog receives a HUP signal. Currently, HUP, USR1, USR2, INT, and
TERM are supported. If unset, no signal is sent on HUP. This is the default
and what pre 8.9.0 versions did.</p>
</div>
<div class="section" id="signalonclose">
<span id="id7"></span><h4>signalOnClose<a class="headerlink" href="#signalonclose" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.23.0.</span></p>
</div>
<p>Specifies whether a TERM signal must be sent to the external program before
closing it (either because the worker thread has been unscheduled, or rsyslog
is about to shutdown).</p>
<p>If this switch is set to “on”, rsyslog will send a TERM signal to the child
process before closing the pipe. That is, the process will first receive a
TERM signal, and then an EOF on stdin.</p>
<p>No signal is issued if this switch is set to “off” (default). The child
process can still detect it must terminate because reading from stdin will
return EOF.</p>
<p>See the <a class="reference internal" href="#killunresponsive">killUnresponsive</a> parameter for more details.</p>
</div>
<div class="section" id="closetimeout">
<span id="id8"></span><h4>closeTimeout<a class="headerlink" href="#closetimeout" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>5000</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.35.0.</span></p>
</div>
<p>Specifies how long rsyslog must wait for the external program to terminate
after closing the pipe (that is, sending EOF to the stdin of the child
process). The value must be expressed in milliseconds and must be greater
than or equal to zero.</p>
<p>See the <a class="reference internal" href="#killunresponsive">killUnresponsive</a> parameter for more details.</p>
</div>
<div class="section" id="killunresponsive">
<span id="id9"></span><h4>killUnresponsive<a class="headerlink" href="#killunresponsive" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>the value of ‘signalOnClose’</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.35.0.</span></p>
</div>
<p>Specifies whether a KILL signal must be sent to the external program in case
it does not terminate within the timeout indicated by <a class="reference internal" href="#closetimeout">closeTimeout</a> (when
rsyslog is shutting down or the worker thread is being unscheduled).</p>
<p>If <a class="reference internal" href="#signalonclose">signalOnClose</a> is set to “on”, the default value of <code class="docutils literal"><span class="pre">killUnresponsive</span></code>
is also “on”. In this case, the cleanup sequence of the child process is as
follows: (1) a TERM signal is sent to the child, (2) the pipe with the child
process is closed (the child will receive EOF on stdin), (3) rsyslog waits
for the child process to terminate during <a class="reference internal" href="#closetimeout">closeTimeout</a>, (4) if the child
has not terminated within the timeout, a KILL signal is sent to it.</p>
<p>If <a class="reference internal" href="#signalonclose">signalOnClose</a> is set to “off”, the default value of <code class="docutils literal"><span class="pre">killUnresponsive</span></code>
is also “off”. In this case, the child cleanup sequence is as follows: (1) the
pipe with the child process is closed (the child will receive EOF on stdin),
(2) rsyslog waits for the child process to terminate during <a class="reference internal" href="#closetimeout">closeTimeout</a>,
(3) if the child has not terminated within the timeout, rsyslog ignores it and
continues with the shutdown (or the unschedule of the worker thread).</p>
<p>This parameter can be set to a different value than <a class="reference internal" href="#signalonclose">signalOnClose</a>, obtaining
the corresponding variations of cleanup sequences described above.</p>
</div>
</div>
<div class="section" id="forcesingleinstance">
<h3>forceSingleInstance<a class="headerlink" href="#forcesingleinstance" title="Permalink to this headline">¶</a></h3>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version v8.1.6.</span></p>
</div>
<p>By default, the omprog action will start an instance (process) of the
external program per worker thread (the maximum number of worker threads
can be specified with the
<a class="reference internal" href="../../rainerscript/queue_parameters.html"><span class="doc">queue.workerThreads</span></a>
parameter). Moreover, if the action is associated to a
<a class="reference internal" href="../../concepts/queues.html"><span class="doc">disk-assisted queue</span></a>, an additional instance
will be started when the queue is persisted, to process the items stored
on disk.</p>
<p>If you want to force a single instance of the program to be executed,
regardless of the number of worker threads or the queue type, set this
flag to “on”. This is useful when the external program uses or accesses
some kind of shared resource that does not allow concurrent access from
multiple processes.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This parameter is currently affected by <a class="reference external" href="https://github.com/rsyslog/rsyslog/issues/2813">this issue</a> that essentially
causes it to have no effect. As a workaround, if you need this
behavior, set the
<a class="reference internal" href="../../rainerscript/queue_parameters.html"><span class="doc">queue.workerThreads</span></a>
parameter to 1 (which is the default value), and do not use a
disk-assisted queue for the omprog action.</p>
</div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-command-line-arguments">
<h3>Example: command line arguments<a class="headerlink" href="#example-command-line-arguments" title="Permalink to this headline">¶</a></h3>
<p>In the following example, logs will be sent to a program <code class="docutils literal"><span class="pre">log.sh</span></code> located
in <code class="docutils literal"><span class="pre">/path/to</span></code>. The program will receive the command line arguments
<code class="docutils literal"><span class="pre">-p=&quot;value</span> <span class="pre">1&quot;</span></code> and <code class="docutils literal"><span class="pre">--param2=&quot;value2&quot;</span></code>.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>module(load=&quot;omprog&quot;)

action(type=&quot;omprog&quot;
       binary=&quot;/path/to/log.sh -p=\&quot;value 1\&quot; --param2=\&quot;value2\&quot;&quot;
       template=&quot;RSYSLOG_TraditionalFileFormat&quot;)
</pre></div>
</div>
</div>
<div class="section" id="example-external-program-that-writes-logs-to-a-database">
<h3>Example: external program that writes logs to a database<a class="headerlink" href="#example-external-program-that-writes-logs-to-a-database" title="Permalink to this headline">¶</a></h3>
<p>In this example, logs are sent to the stdin of a Python program that
(let’s assume) writes them to a database. A dedicated disk-assisted
queue with (a maximum of) 5 worker threads is used, to avoid affecting
other log destinations in moments of high load. The <code class="docutils literal"><span class="pre">confirmMessages</span></code>
flag is enabled, which tells rsyslog to wait for the program to confirm
its initialization and each message received. The purpose of this setup
is preventing logs from being lost because of database connection
failures.</p>
<p>If the program cannot write a log to the database, it will return a
negative confirmation to rsyslog via stdout. Rsyslog will then keep the
failed log  in the queue, and send it again to the program after 5
seconds, with infinite retries.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>module(load=&quot;omprog&quot;)

action(type=&quot;omprog&quot;
       name=&quot;db_forward&quot;
       binary=&quot;/usr/share/logging/db_forward.py&quot;
       confirmMessages=&quot;on&quot;
       queue.type=&quot;LinkedList&quot;
       queue.saveOnShutdown=&quot;on&quot;
       queue.workerThreads=&quot;5&quot;
       action.resumeInterval=&quot;5&quot;
       action.resumeRetryCount=&quot;-1&quot;)
</pre></div>
</div>
<p>Note that the <code class="docutils literal"><span class="pre">useTransactions</span></code> flag is not used in this example. The
program stores and confirms each log individually.</p>
</div>
</div>
<div class="section" id="fmtobsoletename-directives">
<h2><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directives<a class="headerlink" href="#fmtobsoletename-directives" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>$ActionOMProgBinary</strong> &lt;binary&gt;
The binary program to be executed.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Help with configuring/using <code class="docutils literal"><span class="pre">Rsyslog</span></code>:</p>
<ul class="last simple">
<li><a class="reference external" href="http://lists.adiscon.net/mailman/listinfo/rsyslog">Mailing list</a> - best route for general questions</li>
<li>GitHub: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a> - detailed questions, reporting issues
that are believed to be bugs with <code class="docutils literal"><span class="pre">Rsyslog</span></code></li>
<li>Stack Exchange (<a class="reference external" href="https://stackexchange.com/filters/327462/rsyslog">View</a>, <a class="reference external" href="https://serverfault.com/questions/ask?tags=rsyslog">Ask</a>)
- experimental support from rsyslog community</li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Contributing to <code class="docutils literal"><span class="pre">Rsyslog</span></code>:</p>
<ul class="last simple">
<li>Source project: <a class="reference external" href="https://github.com/rsyslog/rsyslog/blob/master/README.md">rsyslog project README</a>.</li>
<li>Documentation: <a class="reference external" href="https://github.com/rsyslog/rsyslog-doc/blob/master/README.md">rsyslog-doc project README</a></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">omprog: Program integration Output module</a><ul>
<li><a class="reference internal" href="#purpose">Purpose</a></li>
<li><a class="reference internal" href="#configuration-parameters">Configuration Parameters</a><ul>
<li><a class="reference internal" href="#action-parameters">Action Parameters</a><ul>
<li><a class="reference internal" href="#template">template</a></li>
<li><a class="reference internal" href="#binary">binary</a></li>
<li><a class="reference internal" href="#confirmmessages">confirmMessages</a></li>
<li><a class="reference internal" href="#usetransactions">useTransactions</a></li>
<li><a class="reference internal" href="#begintransactionmark">beginTransactionMark</a></li>
<li><a class="reference internal" href="#committransactionmark">commitTransactionMark</a></li>
<li><a class="reference internal" href="#output">output</a></li>
<li><a class="reference internal" href="#hup-signal">hup.signal</a></li>
<li><a class="reference internal" href="#signalonclose">signalOnClose</a></li>
<li><a class="reference internal" href="#closetimeout">closeTimeout</a></li>
<li><a class="reference internal" href="#killunresponsive">killUnresponsive</a></li>
</ul>
</li>
<li><a class="reference internal" href="#forcesingleinstance">forceSingleInstance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#example-command-line-arguments">Example: command line arguments</a></li>
<li><a class="reference internal" href="#example-external-program-that-writes-logs-to-a-database">Example: external program that writes logs to a database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fmtobsoletename-directives"><code class="docutils literal"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directives</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ompipe.html"
                        title="previous chapter">ompipe: Pipe Output Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="omrelp.html"
                        title="next chapter">omrelp: RELP Output Module</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/configuration/modules/omprog.rst.txt"
           rel="nofollow">Show Source</a></li>
    <li><a href="https://github.com/rsyslog/rsyslog-doc/edit/master/source/configuration/modules/omprog.rst"
           rel="nofollow">Edit on GitHub</a></li>
  </ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="omrelp.html" title="omrelp: RELP Output Module"
             >next</a> |</li>
        <li class="right" >
          <a href="ompipe.html" title="ompipe: Pipe Output Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">rsyslog 8.37.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Configuration</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Modules</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="idx_output.html" >Output Modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2017, Rainer Gerhards and Others.
    </div>
  </body>
</html>