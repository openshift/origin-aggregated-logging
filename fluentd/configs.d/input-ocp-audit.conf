<source>
  @type tail
  path /var/log/audit/audit-ocp.log
  pos_file /var/log/audit/audit-ocp.pos
  # From 3.9, the advanced audits logs comes in json format by default.
  format json
  tag audit-ocp.log
  @label @OCP_AUDIT
</source>

<label @OCP_AUDIT>
  <filter audit-ocp.log>
    @type record_transformer
    renew_record true
    enable_ruby true
    auto_typecast true
    <record>
      kubernetes {"audit":"${record}"}
      message "this is an audit event"
      level info
      time ${Time.parse(record['timestamp']).to_datetime.rfc3339(6)}
    </record>
  </filter>
  <match audit-ocp.log>
    @type rewrite_tag_filter
    @label @INGRESS
    rewriterule1 message .+ audit.log
  </match>
</label>
