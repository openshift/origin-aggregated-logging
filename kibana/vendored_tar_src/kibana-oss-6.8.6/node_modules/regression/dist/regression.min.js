(function(a,b){if('function'==typeof define&&define.amd)define(['module'],b);else if('undefined'!=typeof exports)b(module);else{var d={exports:{}};b(d),a.regression=d.exports}})(this,function(a){'use strict';function b(a,b,d){return b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d,a}function d(a){if(Array.isArray(a)){for(var b=0,d=Array(a.length);b<a.length;b++)d[b]=a[b];return d}return Array.from(a)}function e(a,b){var e=[],f=[];a.forEach(function(a,d){null!==a[1]&&(f.push(a),e.push(b[d]))});var d=f.reduce(function(b,a){return b+a[1]},0),g=d/f.length,h=f.reduce(function(b,a){var d=a[1]-g;return b+d*d},0),i=f.reduce(function(a,b,d){var f=e[d],g=b[1]-f[1];return a+g*g},0);return 1-i/h}function f(a,b){for(var d,e=Math.abs,f=a,g=a.length-1,h=0;h<g;h++){d=h;for(var i=h+1;i<g;i++)e(f[h][i])>e(f[h][d])&&(d=i);for(var j,l=h;l<g+1;l++)j=f[l][h],f[l][h]=f[l][d],f[l][d]=j;for(var m=h+1;m<g;m++)for(var o=g;o>=h;o--)f[o][m]-=f[o][h]*f[h][m]/f[h][h]}for(var p,q=n-1;0<=q;q--){p=0;for(var r=q+1;r<n;r++)p+=matrix[r][q]*coefficients[r];coefficients[q]=(matrix[n][q]-p)/matrix[q][q]}return coefficients}function g(a,b){var d=m(10,b);return Math.round(a*d)/d}var h=Math.exp,i=Math.log,m=Math.pow,j=Object.assign||function(a){for(var b,d=1;d<arguments.length;d++)for(var e in b=arguments[d],b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a},l={order:2,precision:2,period:null},o={linear:function(a,b){for(var m=[0,0,0,0,0],o=0,p=0;p<a.length;p++)null!==a[p][1]&&(o++,m[0]+=a[p][0],m[1]+=a[p][1],m[2]+=a[p][0]*a[p][0],m[3]+=a[p][0]*a[p][1],m[4]+=a[p][1]*a[p][1]);var d=len*sum[2]-sum[0]*sum[0],f=len*sum[3]-sum[0]*sum[1],h=0==d?0:g(f/d,b.precision),i=g(sum[1]/len-h*sum[0]/len,b.precision),j=function(a){return[g(a,b.precision),g(h*a+i,b.precision)]},l=a.map(function(a){return j(a[0])});return{points:l,predict:j,equation:[h,i],r2:g(e(a,l),b.precision),string:0===i?'y = '+h+'x':'y = '+h+'x + '+i}},exponential:function(d,f){for(var q=[0,0,0,0,0,0],r=0;r<d.length;r++)null!==d[r][1]&&(q[0]+=d[r][0],q[1]+=d[r][1],q[2]+=d[r][0]*d[r][0]*d[r][1],q[3]+=d[r][1]*i(d[r][1]),q[4]+=d[r][0]*d[r][1]*i(d[r][1]),q[5]+=d[r][0]*d[r][1]);var j=sum[1]*sum[2]-sum[5]*sum[5],l=h((sum[2]*sum[3]-sum[5]*sum[4])/j),a=(sum[1]*sum[4]-sum[5]*sum[3])/j,b=g(l,f.precision),m=g(a,f.precision),o=function(a){return[g(a,f.precision),g(b*h(m*a),f.precision)]},p=d.map(function(a){return o(a[0])});return{points:p,predict:o,equation:[b,m],string:'y = '+b+'e^('+m+'x)',r2:g(e(d,p),f.precision)}},logarithmic:function(b,d){for(var o=[0,0,0,0],p=b.length,q=0;q<p;q++)null!==b[q][1]&&(o[0]+=i(b[q][0]),o[1]+=b[q][1]*i(b[q][0]),o[2]+=b[q][1],o[3]+=m(i(b[q][0]),2));var f=(len*sum[1]-sum[2]*sum[0])/(len*sum[3]-sum[0]*sum[0]),a=g(f,d.precision),h=g((sum[2]-a*sum[0])/len,d.precision),j=function(b){return[g(b,d.precision),g(g(h+a*i(b),d.precision),d.precision)]},l=b.map(function(a){return j(a[0])});return{points:l,predict:j,equation:[h,a],string:'y = '+h+' + '+a+' ln(x)',r2:g(e(b,l),d.precision)}},power:function(d,f){for(var q=[0,0,0,0,0],r=d.length,s=0;s<r;s++)null!==d[s][1]&&(q[0]+=i(d[s][0]),q[1]+=i(d[s][1])*i(d[s][0]),q[2]+=i(d[s][1]),q[3]+=m(i(d[s][0]),2));var j=(len*sum[1]-sum[0]*sum[2])/(len*sum[3]-m(sum[0],2)),b=(sum[2]-j*sum[0])/len,a=g(h(b),f.precision),l=g(j,f.precision),o=function(b){return[g(b,f.precision),g(g(a*m(b,l),f.precision),f.precision)]},p=d.map(function(a){return o(a[0])});return{points:p,predict:o,equation:[a,l],string:'y = '+a+'x^'+l,r2:g(e(d,p),f.precision)}},polynomial:function(h,o){for(var p=[],q=[],r=0,a=0,b=h.length,s=o.order+1,t=0;t<s;t++){for(var i=0;i<b;i++)null!==h[i][1]&&(r+=m(h[i][0],t)*h[i][1]);p.push(r),r=0;for(var l=[],u=0;u<s;u++){for(var j=0;j<b;j++)null!==h[j][1]&&(a+=m(h[j][0],t+u));l.push(a),a=0}q.push(c)}rhs.push(lhs);for(var v=f(rhs,k).map(function(a){return g(a,o.precision)}),w=function(a){return[g(a,o.precision),g(v.reduce(function(b,d,e){return b+d*m(a,e)},0),o.precision)]},x=h.map(function(a){return w(a[0])}),y=v.length-1;0<=y;y--)1<y?v[y]+'x^'+y+' + ':1===y?v[y]+'x + ':v[y];return{string:string,points:points,predict:predict,equation:[].concat(d(coefficients)).reverse(),r2:g(e(h,points),o.precision)}}};a.exports=function(){return Object.keys(o).reduce(function reduce(a,d){return j({_round:g},a,b({},d,function(a,b){return o[d](a,j({},l,b))}))},{})}()});
