{"remainingRequest":"/Users/chanderprall/projects/eui/node_modules/babel-loader/lib/index.js!/Users/chanderprall/projects/eui/src/components/outside_click_detector/outside_click_detector.ts","dependencies":[{"path":"/Users/chanderprall/projects/eui/src/components/outside_click_detector/outside_click_detector.ts","mtime":1567626462175},{"path":"/Users/chanderprall/projects/eui/.babelrc.js","mtime":1565204168946},{"path":"/Users/chanderprall/projects/eui/node_modules/cache-loader/dist/cjs.js","mtime":1555436064329},{"path":"/Users/chanderprall/projects/eui/node_modules/babel-loader/lib/index.js","mtime":1543517280769}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EuiOutsideClickDetector = void 0;\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.object.set-prototype-of\");\n\nrequire(\"core-js/modules/es7.array.includes\");\n\nrequire(\"core-js/modules/es6.string.includes\");\n\nvar _react = require(\"react\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _accessibility = require(\"../../services/accessibility\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar EuiOutsideClickDetector =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EuiOutsideClickDetector, _Component);\n\n  // We are working with the assumption that a click event is\n  // equivalent to a sequential, compound press and release of\n  // the pointing device (mouse, finger, stylus, etc.).\n  // A click event's target can be imprecise, as the value will be\n  // the closest common ancestor of the press (mousedown, touchstart)\n  // and relase (mouseup, touchend) events (often <body />) if\n  // the the target of each event differs.\n  // We need the actual event targets to make the correct decisions\n  // about user intention. So, consider the down/start and up/end\n  // items below as the deconstruction of a click event.\n  function EuiOutsideClickDetector(props) {\n    var _this;\n\n    _classCallCheck(this, EuiOutsideClickDetector);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EuiOutsideClickDetector).call(this, props)); // the id is used to identify which EuiOutsideClickDetector\n    // is the source of a click event; as the click event bubbles\n    // up and reaches the click detector's child component the\n    // id value is stamped on the event. This id is inspected\n    // in the document's click handler, and if the id doesn't\n    // exist or doesn't match this detector's id, then trigger\n    // the outsideClick callback.\n    //\n    // Taking this approach instead of checking if the event's\n    // target element exists in this component's DOM sub-tree is\n    // necessary for handling clicks originating from children\n    // rendered through React's portals (EuiPortal). The id tracking\n    // works because React guarantees the event bubbles through the\n    // virtual DOM and executes EuiClickDetector's onClick handler,\n    // stamping the id even though the event originates outside\n    // this component's reified DOM tree.\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"id\", void 0);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"capturedDownIds\", void 0);\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onClickOutside\", function (event) {\n      var _this$props = _this.props,\n          isDisabled = _this$props.isDisabled,\n          onOutsideClick = _this$props.onOutsideClick;\n\n      if (isDisabled) {\n        _this.capturedDownIds = [];\n        return;\n      }\n\n      if (event.euiGeneratedBy && event.euiGeneratedBy.includes(_this.id) || _this.capturedDownIds.includes(_this.id)) {\n        _this.capturedDownIds = [];\n        return;\n      }\n\n      _this.capturedDownIds = [];\n      return onOutsideClick(event);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onChildClick\", function (event, cb) {\n      // to support nested click detectors, build an array\n      // of detector ids that have been encountered\n      if (event.nativeEvent.hasOwnProperty('euiGeneratedBy')) {\n        event.nativeEvent.euiGeneratedBy.push(_this.id);\n      } else {\n        event.nativeEvent.euiGeneratedBy = [_this.id];\n      }\n\n      if (cb) cb(event);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onChildMouseDown\", function (event) {\n      _this.onChildClick(event, function (e) {\n        _this.capturedDownIds = e.nativeEvent.euiGeneratedBy;\n        if (_this.props.onMouseDown) _this.props.onMouseDown(e);\n        if (_this.props.onTouchStart) _this.props.onTouchStart(e);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onChildMouseUp\", function (event) {\n      _this.onChildClick(event, function (e) {\n        if (_this.props.onMouseUp) _this.props.onMouseUp(e);\n        if (_this.props.onTouchEnd) _this.props.onTouchEnd(e);\n      });\n    });\n\n    _this.id = (0, _accessibility.htmlIdGenerator)()();\n    _this.capturedDownIds = [];\n    return _this;\n  }\n\n  _createClass(EuiOutsideClickDetector, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener('mouseup', this.onClickOutside);\n      document.addEventListener('touchend', this.onClickOutside);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('mouseup', this.onClickOutside);\n      document.removeEventListener('touchend', this.onClickOutside);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = _objectSpread({}, this.props.children.props, {\n        onMouseDown: this.onChildMouseDown,\n        onTouchStart: this.onChildMouseDown,\n        onMouseUp: this.onChildMouseUp,\n        onTouchEnd: this.onChildMouseUp\n      });\n\n      var child = _react.Children.only(this.props.children);\n\n      return (0, _react.cloneElement)(child, props);\n    }\n  }]);\n\n  return EuiOutsideClickDetector;\n}(_react.Component);\n\nexports.EuiOutsideClickDetector = EuiOutsideClickDetector;\nEuiOutsideClickDetector.propTypes = {\n  children: _propTypes.default.element.isRequired,\n  onOutsideClick: _propTypes.default.func.isRequired,\n  isDisabled: _propTypes.default.bool,\n  onMouseDown: _propTypes.default.func,\n  onMouseUp: _propTypes.default.func,\n  onTouchStart: _propTypes.default.func,\n  onTouchEnd: _propTypes.default.func\n};\nEuiOutsideClickDetector.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [{\n    \"name\": \"onClickOutside\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"event\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"onChildClick\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"event\",\n      \"type\": null\n    }, {\n      \"name\": \"cb\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"onChildMouseDown\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"event\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"onChildMouseUp\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"event\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }],\n  \"displayName\": \"EuiOutsideClickDetector\",\n  \"props\": {\n    \"children\": {\n      \"type\": {\n        \"name\": \"element\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"onOutsideClick\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"isDisabled\": {\n      \"type\": {\n        \"name\": \"bool\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"onMouseDown\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"onMouseUp\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"onTouchStart\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"onTouchEnd\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    }\n  }\n};",{"version":3,"sources":["/Users/chanderprall/projects/eui/src/components/outside_click_detector/outside_click_detector.ts"],"names":["EuiOutsideClickDetector","props","event","isDisabled","onOutsideClick","capturedDownIds","euiGeneratedBy","includes","id","cb","nativeEvent","hasOwnProperty","push","onChildClick","e","onMouseDown","onTouchStart","onMouseUp","onTouchEnd","document","addEventListener","onClickOutside","removeEventListener","children","onChildMouseDown","onChildMouseUp","child","Children","only","Component"],"mappings":"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","sourcesContent":["import { Children, cloneElement, Component } from 'react';\nimport PropTypes from \"prop-types\";\nimport { htmlIdGenerator } from '../../services/accessibility';\nexport class EuiOutsideClickDetector extends Component {\n  // We are working with the assumption that a click event is\n  // equivalent to a sequential, compound press and release of\n  // the pointing device (mouse, finger, stylus, etc.).\n  // A click event's target can be imprecise, as the value will be\n  // the closest common ancestor of the press (mousedown, touchstart)\n  // and relase (mouseup, touchend) events (often <body />) if\n  // the the target of each event differs.\n  // We need the actual event targets to make the correct decisions\n  // about user intention. So, consider the down/start and up/end\n  // items below as the deconstruction of a click event.\n  constructor(props) {\n    super(props); // the id is used to identify which EuiOutsideClickDetector\n    // is the source of a click event; as the click event bubbles\n    // up and reaches the click detector's child component the\n    // id value is stamped on the event. This id is inspected\n    // in the document's click handler, and if the id doesn't\n    // exist or doesn't match this detector's id, then trigger\n    // the outsideClick callback.\n    //\n    // Taking this approach instead of checking if the event's\n    // target element exists in this component's DOM sub-tree is\n    // necessary for handling clicks originating from children\n    // rendered through React's portals (EuiPortal). The id tracking\n    // works because React guarantees the event bubbles through the\n    // virtual DOM and executes EuiClickDetector's onClick handler,\n    // stamping the id even though the event originates outside\n    // this component's reified DOM tree.\n\n    this.id = htmlIdGenerator()();\n    this.capturedDownIds = [];\n  }\n\n  onClickOutside = event => {\n    const {\n      isDisabled,\n      onOutsideClick\n    } = this.props;\n\n    if (isDisabled) {\n      this.capturedDownIds = [];\n      return;\n    }\n\n    if (event.euiGeneratedBy && event.euiGeneratedBy.includes(this.id) || this.capturedDownIds.includes(this.id)) {\n      this.capturedDownIds = [];\n      return;\n    }\n\n    this.capturedDownIds = [];\n    return onOutsideClick(event);\n  };\n\n  componentDidMount() {\n    document.addEventListener('mouseup', this.onClickOutside);\n    document.addEventListener('touchend', this.onClickOutside);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mouseup', this.onClickOutside);\n    document.removeEventListener('touchend', this.onClickOutside);\n  }\n\n  onChildClick = (event, cb) => {\n    // to support nested click detectors, build an array\n    // of detector ids that have been encountered\n    if (event.nativeEvent.hasOwnProperty('euiGeneratedBy')) {\n      event.nativeEvent.euiGeneratedBy.push(this.id);\n    } else {\n      event.nativeEvent.euiGeneratedBy = [this.id];\n    }\n\n    if (cb) cb(event);\n  };\n  onChildMouseDown = event => {\n    this.onChildClick(event, e => {\n      this.capturedDownIds = e.nativeEvent.euiGeneratedBy;\n      if (this.props.onMouseDown) this.props.onMouseDown(e);\n      if (this.props.onTouchStart) this.props.onTouchStart(e);\n    });\n  };\n  onChildMouseUp = event => {\n    this.onChildClick(event, e => {\n      if (this.props.onMouseUp) this.props.onMouseUp(e);\n      if (this.props.onTouchEnd) this.props.onTouchEnd(e);\n    });\n  };\n\n  render() {\n    const props = { ...this.props.children.props,\n      ...{\n        onMouseDown: this.onChildMouseDown,\n        onTouchStart: this.onChildMouseDown,\n        onMouseUp: this.onChildMouseUp,\n        onTouchEnd: this.onChildMouseUp\n      }\n    };\n    const child = Children.only(this.props.children);\n    return cloneElement(child, props);\n  }\n\n}\nEuiOutsideClickDetector.propTypes = {\n  children: PropTypes.element.isRequired,\n  onOutsideClick: PropTypes.func.isRequired,\n  isDisabled: PropTypes.bool,\n  onMouseDown: PropTypes.func,\n  onMouseUp: PropTypes.func,\n  onTouchStart: PropTypes.func,\n  onTouchEnd: PropTypes.func\n};"]}]}