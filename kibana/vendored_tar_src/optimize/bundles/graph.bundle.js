/*! Copyright Elasticsearch B.V. and/or license to Elasticsearch B.V. under one or more contributor license agreements
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var executeModules=data[2];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}deferredModules.push.apply(deferredModules,executeModules||[]);return checkDeferredModules()}function checkDeferredModules(){var result;for(var i=0;i<deferredModules.length;i++){var deferredModule=deferredModules[i];var fulfilled=true;for(var j=1;j<deferredModule.length;j++){var depId=deferredModule[j];if(installedChunks[depId]!==0)fulfilled=false}if(fulfilled){deferredModules.splice(i--,1);result=__webpack_require__(__webpack_require__.s=deferredModule[0])}}return result}var installedModules={};var installedChunks={4:0};var deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="__REPLACE_WITH_PUBLIC_PATH__";var jsonpArray=window["webpackJsonp"]=window["webpackJsonp"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([1505,0]);return checkDeferredModules()})({1094:function(module,exports,__webpack_require__){module.exports=__webpack_require__(9)(3470)},1505:function(module,exports,__webpack_require__){"use strict";__webpack_require__(71);__webpack_require__(72);__webpack_require__(73);__webpack_require__(74);__webpack_require__(75);__webpack_require__(76);__webpack_require__(77);__webpack_require__(78);__webpack_require__(79);__webpack_require__(80);__webpack_require__(81);__webpack_require__(82);__webpack_require__(83);__webpack_require__(84);__webpack_require__(85);__webpack_require__(86);__webpack_require__(87);__webpack_require__(88);__webpack_require__(89);__webpack_require__(90);__webpack_require__(91);__webpack_require__(92);__webpack_require__(93);__webpack_require__(94);__webpack_require__(95);__webpack_require__(96);__webpack_require__(97);__webpack_require__(98);__webpack_require__(99);__webpack_require__(100);__webpack_require__(101);__webpack_require__(102);__webpack_require__(103);__webpack_require__(104);__webpack_require__(105);__webpack_require__(106);__webpack_require__(107);__webpack_require__(108);__webpack_require__(109);__webpack_require__(110);__webpack_require__(111);__webpack_require__(112);__webpack_require__(113);__webpack_require__(114);__webpack_require__(115);__webpack_require__(116);__webpack_require__(117);__webpack_require__(118);__webpack_require__(119);__webpack_require__(120);__webpack_require__(121);__webpack_require__(122);__webpack_require__(123);__webpack_require__(124);__webpack_require__(125);__webpack_require__(126);__webpack_require__(127);__webpack_require__(128);__webpack_require__(129);__webpack_require__(130);__webpack_require__(131);__webpack_require__(132);__webpack_require__(133);__webpack_require__(134);__webpack_require__(135);__webpack_require__(136);__webpack_require__(137);__webpack_require__(138);__webpack_require__(139);__webpack_require__(140);__webpack_require__(141);__webpack_require__(142);__webpack_require__(143);__webpack_require__(144);__webpack_require__(145);__webpack_require__(146);__webpack_require__(147);__webpack_require__(148);__webpack_require__(149);__webpack_require__(150);__webpack_require__(151);__webpack_require__(152);__webpack_require__(153);__webpack_require__(154);__webpack_require__(155);__webpack_require__(156);__webpack_require__(157);__webpack_require__(158);__webpack_require__(159);__webpack_require__(160);__webpack_require__(161);__webpack_require__(162);__webpack_require__(163);__webpack_require__(164);__webpack_require__(165);__webpack_require__(166);__webpack_require__(167);__webpack_require__(168);__webpack_require__(169);__webpack_require__(173);var _i18n=__webpack_require__(4);var _kibanaCore__=__webpack_require__(170);var injectedMetadata=JSON.parse(document.querySelector("kbn-injected-metadata").getAttribute("data"));_i18n.i18n.load(injectedMetadata.i18n.translationsUrl).catch(function(e){return e}).then(function(i18nError){var coreSystem=new _kibanaCore__.CoreSystem({injectedMetadata:injectedMetadata,rootDomElement:document.body,requireLegacyFiles:function requireLegacyFiles(){__webpack_require__(1733)}});var coreStartContract=coreSystem.start();if(i18nError){coreStartContract.fatalErrors.add(i18nError)}})},1733:function(module,exports,__webpack_require__){"use strict";var _d=__webpack_require__(21);var _d2=_interopRequireDefault(_d);__webpack_require__(212);var _risonNode=__webpack_require__(238);var _risonNode2=_interopRequireDefault(_risonNode);var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);__webpack_require__(320);__webpack_require__(356);__webpack_require__(203);__webpack_require__(665);var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _modules=__webpack_require__(6);var _routes=__webpack_require__(14);var _routes2=_interopRequireDefault(_routes);var _notify=__webpack_require__(10);var _index_patterns=__webpack_require__(638);var _saved_objects=__webpack_require__(50);var _kibana_parsed_url=__webpack_require__(620);var _xpack_info=__webpack_require__(44);var _index=__webpack_require__(2025);var _index2=_interopRequireDefault(_index);var _react3=__webpack_require__(3);__webpack_require__(2026);var _graphClientWorkspace=__webpack_require__(2027);var _graphClientWorkspace2=_interopRequireDefault(_graphClientWorkspace);var _utils=__webpack_require__(2028);var _utils2=_interopRequireDefault(_utils);var _saved_workspaces=__webpack_require__(2029);var _style_choices=__webpack_require__(2031);var _outlink_encoders=__webpack_require__(2032);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var app=_modules.uiModules.get("app/graph");function checkLicense(Private,Promise,kbnBaseUrl){var xpackInfo=Private(_xpack_info.XPackInfoProvider);var licenseAllowsToShowThisPage=xpackInfo.get("features.graph.showAppLink")&&xpackInfo.get("features.graph.enableAppLink");if(!licenseAllowsToShowThisPage){var message=xpackInfo.get("features.graph.message");var newUrl=(0,_notify.addAppRedirectMessageToUrl)(_chrome2.default.addBasePath(kbnBaseUrl),message);window.location.href=newUrl;return Promise.halt()}return Promise.resolve()}app.directive("focusOn",function(){return function(scope,elem,attr){scope.$on(attr.focusOn,function(){elem[0].focus()})}});if(_routes2.default.enable){_routes2.default.enable()}_routes2.default.when("/home",{template:_index2.default,resolve:{indexPatterns:function indexPatterns(Private){var savedObjectsClient=Private(_saved_objects.SavedObjectsClientProvider);return savedObjectsClient.find({type:"index-pattern",fields:["title","type"],perPage:1e4}).then(function(response){return response.savedObjects})},GetIndexPatternProvider:function GetIndexPatternProvider(Private){return Private(_index_patterns.IndexPatternsProvider)},SavedWorkspacesProvider:function SavedWorkspacesProvider(Private){return Private(_saved_workspaces.SavedWorkspacesProvider)},CheckLicense:checkLicense}}).when("/workspace/:id",{template:_index2.default,resolve:{savedWorkspace:function savedWorkspace(savedGraphWorkspaces,courier,$route,i18n){return savedGraphWorkspaces.get($route.current.params.id).catch(function(){_notify.toastNotifications.addDanger(i18n("xpack.graph.missingWorkspaceErrorMessage",{defaultMessage:"Missing workspace"}))})},indexPatterns:function indexPatterns(Private){var savedObjectsClient=Private(_saved_objects.SavedObjectsClientProvider);return savedObjectsClient.find({type:"index-pattern",fields:["title","type"],perPage:1e4}).then(function(response){return response.savedObjects})},GetIndexPatternProvider:function GetIndexPatternProvider(Private){return Private(_index_patterns.IndexPatternsProvider)},SavedWorkspacesProvider:function SavedWorkspacesProvider(Private){return Private(_saved_workspaces.SavedWorkspacesProvider)},CheckLicense:checkLicense}}).otherwise({redirectTo:"/home"});app.controller("graphuiPlugin",function($scope,$route,$interval,$http,kbnUrl,Private,Promise,confirmModal,kbnBaseUrl,i18n){function handleSuccess(data){return checkLicense(Private,Promise,kbnBaseUrl).then(function(){return data})}function handleError(err){return checkLicense(Private,Promise,kbnBaseUrl).then(function(){return _notify.notify.error(err)})}$scope.title="Graph";$scope.spymode="request";$scope.iconChoices=_style_choices.iconChoices;$scope.drillDownIconChoices=_style_choices.drillDownIconChoices;$scope.colors=_style_choices.colorChoices;$scope.iconChoicesByClass=_style_choices.iconChoicesByClass;$scope.outlinkEncoders=(0,_outlink_encoders.getOutlinkEncoders)(i18n);$scope.fields=[];$scope.canEditDrillDownUrls=_chrome2.default.getInjected("canEditDrillDownUrls");$scope.graphSavePolicy=_chrome2.default.getInjected("graphSavePolicy");$scope.allSavingDisabled=$scope.graphSavePolicy==="none";$scope.searchTerm="";$scope.grr=$scope;$scope.applyColor=function(fieldDef,color){fieldDef.color=color;if($scope.workspace){$scope.workspace.nodes.forEach(function(node){if(node.data.field===fieldDef.name){node.color=color}})}};$scope.applyIcon=function(fieldDef,icon){fieldDef.icon=icon;if($scope.workspace){$scope.workspace.nodes.forEach(function(node){if(node.data.field===fieldDef.name){node.icon=icon}})}};$scope.toggleDrillDownIcon=function(urlTemplate,icon){urlTemplate.icon===icon?urlTemplate.icon=null:urlTemplate.icon=icon};$scope.openSavedWorkspace=function(savedWorkspace){kbnUrl.change("/workspace/{{id}}",{id:savedWorkspace.id})};$scope.nodeClick=function(n,$event){if(!$event.shiftKey){var prevSelection=n.isSelected;$scope.workspace.selectNone();n.isSelected=prevSelection}if($scope.workspace.toggleNodeSelection(n)){$scope.selectSelected(n)}else{$scope.detail=null}};$scope.updateLiveResponseFields=function(){$scope.liveResponseFields=$scope.selectedFields.filter(function(fieldDef){return fieldDef.hopSize>0&&fieldDef.selected})};$scope.selectedFieldConfigHopSizeChanged=function(){$scope.updateLiveResponseFields()};$scope.hideAllConfigPanels=function(){$scope.selectedFieldConfig=null;$scope.kbnTopNav.close()};$scope.setAllFieldStatesToDefault=function(){$scope.selectedFields=[];$scope.basicModeSelectedSingleField=null;$scope.liveResponseFields=[];$scope.allFields.forEach(function(fieldDef){fieldDef.selected=false})};$scope.addFieldToSelection=function(){$scope.selectedField.selected=true;if($scope.selectedFields.indexOf($scope.selectedField)<0){$scope.selectedFields.push($scope.selectedField)}$scope.updateLiveResponseFields();$scope.clickVertexFieldIcon($scope.selectedField)};$scope.clickVertexFieldIcon=function(field,$event){if($event&&field){if($event.shiftKey){if(field.hopSize===0){field.hopSize=field.lastValidHopSize?field.lastValidHopSize:5}else{field.lastValidHopSize=field.hopSize;field.hopSize=0}$scope.updateLiveResponseFields();return}}if($scope.kbnTopNav.currentKey==="fieldConfig"&&field===$scope.selectedFieldConfig){$scope.hideAllConfigPanels();return}$scope.hideAllConfigPanels();$scope.selectedFieldConfig=field;$scope.kbnTopNav.currentKey="fieldConfig"};function canWipeWorkspace(yesFn,noFn){if($scope.selectedFields.length===0&&$scope.workspace===null){yesFn();return}var confirmModalOptions={onConfirm:yesFn,onCancel:noFn,confirmButtonText:i18n("xpack.graph.clearWorkspace.confirmButtonLabel",{defaultMessage:"Clear workspace"})};confirmModal(i18n("xpack.graph.clearWorkspace.confirmText",{defaultMessage:"This will clear the workspace - are you sure?"}),confirmModalOptions)}$scope.uiSelectIndex=function(){canWipeWorkspace(function(){$scope.indexSelected($scope.proposedIndex)},function(){$scope.proposedIndex=$scope.selectedIndex})};$scope.indexSelected=function(selectedIndex,postInitHandler){$scope.clearWorkspace();$scope.allFields=[];$scope.selectedFields=[];$scope.basicModeSelectedSingleField=null;$scope.selectedField=null;$scope.selectedFieldConfig=null;$scope.selectedIndex=selectedIndex;$scope.proposedIndex=selectedIndex;var promise=$route.current.locals.GetIndexPatternProvider.get(selectedIndex.id);promise.then(handleSuccess).then(function(indexPattern){var patternFields=indexPattern.getNonScriptedFields();var blockedFieldNames=["_id","_index","_score","_source","_type"];patternFields.forEach(function(field,index){if(blockedFieldNames.indexOf(field.name)>=0){return}var graphFieldDef={name:field.name};$scope.allFields.push(graphFieldDef);graphFieldDef.hopSize=5;graphFieldDef.lastValidHopSize=graphFieldDef.hopSize;graphFieldDef.icon=$scope.iconChoices[0];for(var i=0;i<$scope.iconChoices.length;i++){var icon=$scope.iconChoices[i];for(var p=0;p<icon.patterns.length;p++){var pattern=icon.patterns[p];if(pattern.test(graphFieldDef.name)){graphFieldDef.icon=icon;break}}}graphFieldDef.color=$scope.colors[index%$scope.colors.length]});$scope.setAllFieldStatesToDefault();$scope.allFields.sort(function(a,b){if(a.name<b.name){return-1}else if(a.name>b.name){return 1}return 0});$scope.filteredFields=$scope.allFields;if($scope.allFields.length>0){$scope.selectedField=$scope.allFields[0]}if(postInitHandler){postInitHandler()}},handleError)};$scope.clickEdge=function(edge){if(edge.inferred){$scope.setDetail({inferredEdge:edge})}else{$scope.workspace.getAllIntersections($scope.handleMergeCandidatesCallback,[edge.topSrc,edge.topTarget])}};function callNodeProxy(indexName,query,responseHandler){var request={index:indexName,query:query};return $http.post("../api/graph/graphExplore",request).then(function(resp){if(resp.data.resp.timed_out){_notify.toastNotifications.addWarning(i18n("xpack.graph.exploreGraph.timedOutWarningText",{defaultMessage:"Exploration timed out"}))}responseHandler(resp.data.resp)}).catch(handleError)}var callSearchNodeProxy=function callSearchNodeProxy(indexName,query,responseHandler){var request={index:indexName,body:query};$http.post("../api/graph/searchProxy",request).then(function(resp){responseHandler(resp.data.resp)}).catch(handleError)};$scope.submit=function(){$scope.hideAllConfigPanels();initWorkspaceIfRequired();var numHops=2;if($scope.searchTerm.startsWith("{")){try{var query=JSON.parse($scope.searchTerm);if(query.vertices){$scope.workspace.callElasticsearch(query)}else{$scope.workspace.search(query,$scope.liveResponseFields,numHops)}}catch(err){handleError(err)}return}$scope.workspace.simpleSearch($scope.searchTerm,$scope.liveResponseFields,numHops)};$scope.clearWorkspace=function(){$scope.workspace=null;$scope.detail=null;if($scope.kbnTopNav){$scope.kbnTopNav.close()}};$scope.toggleShowAdvancedFieldsConfig=function(){if($scope.kbnTopNav.currentKey!=="fields"){$scope.kbnTopNav.close();$scope.kbnTopNav.currentKey="fields";$scope.selectedField=null;$scope.filteredFields=$scope.allFields.filter(function(fieldDef){return!fieldDef.selected});if($scope.filteredFields.length>0){$scope.selectedField=$scope.filteredFields[0]}}else{$scope.hideAllConfigPanels()}};$scope.removeVertexFieldSelection=function(){$scope.selectedFieldConfig.selected=false;var i=$scope.selectedFields.indexOf($scope.selectedFieldConfig);if(i!==-1){$scope.selectedFields.splice(i,1)}$scope.updateLiveResponseFields();$scope.hideAllConfigPanels()};$scope.selectSelected=function(node){$scope.detail={latestNodeSelection:node};return $scope.selectedSelectedVertex=node};$scope.isSelectedSelected=function(node){return $scope.selectedSelectedVertex===node};$scope.filterFieldsKeyDown=function(){var lcFilter=$scope.fieldNamesFilterString.toLowerCase();$scope.filteredFields=$scope.allFields.filter(function(fieldDef){return!fieldDef.selected&&(!lcFilter||lcFilter===""||fieldDef.name.toLowerCase().indexOf(lcFilter)>=0)})};var defaultKibanaQuery=",query:(query_string:(analyze_wildcard:!t,query:'*'))";var drillDownRegex=/\{\{gquery\}\}/;$scope.checkForKibanaUrl=function(){$scope.suggestTemplateFix=$scope.newUrlTemplate.url===$scope.lastPastedURL&&$scope.newUrlTemplate.url.indexOf(defaultKibanaQuery)>0};$scope.replaceKibanaUrlParam=function(){$scope.newUrlTemplate.url=$scope.newUrlTemplate.url.replace(defaultKibanaQuery,",query:{{gquery}}");$scope.lastPastedURL=null;$scope.checkForKibanaUrl()};$scope.rejectKibanaUrlSuggestion=function(){$scope.lastPastedURL=null;$scope.checkForKibanaUrl()};function detectKibanaUrlPaste(url){$scope.lastPastedURL=url;$scope.checkForKibanaUrl()}$scope.handleUrlTemplatePaste=function($event){window.setTimeout(function(){detectKibanaUrlPaste(angular.element($event.currentTarget).val());$scope.$digest()},0)};$scope.resetNewUrlTemplate=function(){$scope.newUrlTemplate={url:null,description:null,encoder:$scope.outlinkEncoders[0]}};$scope.editUrlTemplate=function(urlTemplate){Object.assign($scope.newUrlTemplate,urlTemplate,{templateBeingEdited:urlTemplate})};$scope.saveUrlTemplate=function(){var found=$scope.newUrlTemplate.url.search(drillDownRegex)>-1;if(!found){_notify.toastNotifications.addWarning({title:i18n("xpack.graph.settings.drillDowns.invalidUrlWarningTitle",{defaultMessage:"Invalid URL"}),text:i18n("xpack.graph.settings.drillDowns.invalidUrlWarningText",{defaultMessage:"The URL must contain a {placeholder} string",values:{placeholder:"{{gquery}}"}})});return}if($scope.newUrlTemplate.templateBeingEdited){if($scope.urlTemplates.indexOf($scope.newUrlTemplate.templateBeingEdited)>=0){Object.assign($scope.newUrlTemplate.templateBeingEdited,$scope.newUrlTemplate);return}}$scope.urlTemplates.push($scope.newUrlTemplate);$scope.resetNewUrlTemplate()};$scope.removeUrlTemplate=function(urlTemplate){var i=$scope.urlTemplates.indexOf(urlTemplate);if(i!=-1){confirmModal(i18n("xpack.graph.settings.drillDowns.removeConfirmText",{defaultMessage:'Remove "{urlTemplateDesciption}" drill-down?',values:{urlTemplateDesciption:urlTemplate.description}}),{onConfirm:function onConfirm(){return $scope.urlTemplates.splice(i,1)},confirmButtonText:i18n("xpack.graph.settings.drillDowns.removeConfirmButtonLabel",{defaultMessage:"Remove drill-down"})})}};$scope.openUrlTemplate=function(template){var url=template.url;var newUrl=url.replace(drillDownRegex,template.encoder.encode($scope.workspace));window.open(newUrl,"_blank")};$scope.resetWorkspace=function(){$scope.clearWorkspace();$scope.userHasConfirmedSaveWorkspaceData=false;$scope.selectedIndex=null;$scope.proposedIndex=null;$scope.detail=null;$scope.selectedSelectedVertex=null;$scope.selectedField=null;$scope.description=null;$scope.allFields=[];$scope.urlTemplates=[];$scope.resetNewUrlTemplate();$scope.fieldNamesFilterString=null;$scope.filteredFields=[];$scope.selectedFields=[];$scope.configPanel="settings";$scope.liveResponseFields=[];$scope.exploreControls={useSignificance:true,sampleSize:2e3,timeoutMillis:5e3,sampleDiversityField:null,maxValuesPerDoc:1,minDocCount:3}};function initWorkspaceIfRequired(){if($scope.workspace){return}var options={indexName:$scope.selectedIndex.attributes.title,vertex_fields:$scope.selectedFields,nodeLabeller:function nodeLabeller(){},changeHandler:function changeHandler(){$scope.$apply()},graphExploreProxy:callNodeProxy,searchProxy:callSearchNodeProxy,exploreControls:$scope.exploreControls};$scope.workspace=_graphClientWorkspace2.default.createWorkspace(options);$scope.detail=null;if($scope.urlTemplates.length===0){var tag="{{gquery}}";var kUrl=new _kibana_parsed_url.KibanaParsedUrl({appId:"kibana",basePath:_chrome2.default.getBasePath(),appPath:"/discover"});kUrl.addQueryParameter("_a",_risonNode2.default.encode({columns:["_source"],index:$scope.selectedIndex.id,interval:"auto",query:tag,sort:["_score","desc"]}));var discoverUrl=kUrl.getRootRelativePath().replace(encodeURIComponent(tag),tag);$scope.urlTemplates.push({url:discoverUrl,description:i18n("xpack.graph.settings.drillDowns.defaultUrlTemplateTitle",{defaultMessage:"Raw documents"}),encoder:$scope.outlinkEncoders[0]})}}$scope.indices=$route.current.locals.indexPatterns.filter(function(indexPattern){return!indexPattern.get("type")});$scope.setDetail=function(data){$scope.detail=data};$scope.performMerge=function(parentId,childId){var found=true;while(found){found=false;for(var i in $scope.detail.mergeCandidates){var mc=$scope.detail.mergeCandidates[i];if(mc.id1===childId||mc.id2===childId){$scope.detail.mergeCandidates.splice(i,1);found=true;break}}}$scope.workspace.mergeIds(parentId,childId);$scope.detail=null};$scope.handleMergeCandidatesCallback=function(termIntersects){$scope.detail={mergeCandidates:_utils2.default.getMergeSuggestionObjects(termIntersects)}};var redraw=function redraw(){_d2.default.select("#svgRootGroup").attr("transform","translate("+_d2.default.event.translate+")"+"scale("+_d2.default.event.scale+")").attr("style","stroke-width: "+1/_d2.default.event.scale);if($scope.zoomLevel!==_d2.default.event.scale){$scope.zoomLevel=_d2.default.event.scale;$scope.$apply()}};$scope.resetWorkspace();var blockScroll=function blockScroll(){_d2.default.event.preventDefault()};_d2.default.select("#graphSvg").on("mousewheel",blockScroll).on("DOMMouseScroll",blockScroll).call(_d2.default.behavior.zoom().on("zoom",redraw));var managementUrl=_chrome2.default.getNavLinkById("kibana:management").url;var url=managementUrl+"/kibana/indices";if($scope.indices.length===0){_notify.toastNotifications.addWarning({title:i18n("xpack.graph.noDataSourceNotificationMessageTitle",{defaultMessage:"No data source"}),text:_react2.default.createElement("p",null,_react2.default.createElement(_react3.FormattedMessage,{id:"xpack.graph.noDataSourceNotificationMessageText",defaultMessage:"Go to {managementIndexPatternsLink} and create an index pattern",values:{managementIndexPatternsLink:_react2.default.createElement("a",{href:url},_react2.default.createElement(_react3.FormattedMessage,{id:"xpack.graph.noDataSourceNotificationMessageText.managementIndexPatternLinkText",defaultMessage:"Management > Index Patterns"}))}}))})}$scope.topNavMenu=[];$scope.topNavMenu.push({key:"new",label:i18n("xpack.graph.topNavMenu.newWorkspaceLabel",{defaultMessage:"New"}),description:i18n("xpack.graph.topNavMenu.newWorkspaceAriaLabel",{defaultMessage:"New Workspace"}),tooltip:i18n("xpack.graph.topNavMenu.newWorkspaceTooltip",{defaultMessage:"Create a new workspace"}),run:function run(){canWipeWorkspace(function(){kbnUrl.change("/home",{})})}});if(!$scope.allSavingDisabled){$scope.topNavMenu.push({key:"save",label:i18n("xpack.graph.topNavMenu.saveWorkspace.enabledLabel",{defaultMessage:"Save"}),description:i18n("xpack.graph.topNavMenu.saveWorkspace.enabledAriaLabel",{defaultMessage:"Save Workspace"}),tooltip:i18n("xpack.graph.topNavMenu.saveWorkspace.enabledTooltip",{defaultMessage:"Save this workspace"}),disableButton:function disableButton(){return $scope.selectedFields.length===0},template:__webpack_require__(2033)})}else{$scope.topNavMenu.push({key:"save",label:i18n("xpack.graph.topNavMenu.saveWorkspace.disabledLabel",{defaultMessage:"Save"}),description:i18n("xpack.graph.topNavMenu.saveWorkspace.disabledAriaLabel",{defaultMessage:"Save Workspace"}),tooltip:i18n("xpack.graph.topNavMenu.saveWorkspace.disabledTooltip",{defaultMessage:"No changes to saved workspaces are permitted by the current save policy"}),disableButton:true})}$scope.topNavMenu.push({key:"open",label:i18n("xpack.graph.topNavMenu.loadWorkspaceLabel",{defaultMessage:"Open"}),description:i18n("xpack.graph.topNavMenu.loadWorkspaceAriaLabel",{defaultMessage:"Load Saved Workspace"}),tooltip:i18n("xpack.graph.topNavMenu.loadWorkspaceTooltip",{defaultMessage:"Load a saved workspace"}),template:__webpack_require__(2034)});if(!$scope.allSavingDisabled){$scope.topNavMenu.push({key:"delete",disableButton:function disableButton(){return $route.current.locals===undefined||$route.current.locals.savedWorkspace===undefined},label:i18n("xpack.graph.topNavMenu.deleteWorkspace.enabledLabel",{defaultMessage:"Delete"}),description:i18n("xpack.graph.topNavMenu.deleteWorkspace.enabledAriaLabel",{defaultMessage:"Delete Saved Workspace"}),tooltip:i18n("xpack.graph.topNavMenu.deleteWorkspace.enabledAriaTooltip",{defaultMessage:"Delete this workspace"}),run:function run(){var title=$route.current.locals.savedWorkspace.title;function doDelete(){$route.current.locals.SavedWorkspacesProvider.delete($route.current.locals.savedWorkspace.id);kbnUrl.change("/home",{});_notify.toastNotifications.addSuccess(i18n("xpack.graph.topNavMenu.deleteWorkspaceNotification",{defaultMessage:"Deleted '{workspaceTitle}'",values:{workspaceTitle:title}}))}var confirmModalOptions={onConfirm:doDelete,confirmButtonText:i18n("xpack.graph.topNavMenu.deleteWorkspace.confirmButtonLabel",{defaultMessage:"Delete workspace"})};confirmModal(i18n("xpack.graph.topNavMenu.deleteWorkspace.confirmText",{defaultMessage:"Are you sure you want to delete the workspace {title} ?",values:{title:title}}),confirmModalOptions)}})}else{$scope.topNavMenu.push({key:"delete",disableButton:true,label:i18n("xpack.graph.topNavMenu.deleteWorkspace.disabledLabel",{defaultMessage:"Delete"}),description:i18n("xpack.graph.topNavMenu.deleteWorkspace.disabledAriaLabel",{defaultMessage:"Delete Saved Workspace"}),tooltip:i18n("xpack.graph.topNavMenu.deleteWorkspace.disabledTooltip",{defaultMessage:"No changes to saved workspaces are permitted by the current save policy"})})}$scope.topNavMenu.push({key:"settings",disableButton:function disableButton(){return $scope.selectedIndex===null},label:i18n("xpack.graph.topNavMenu.settingsLabel",{defaultMessage:"Settings"}),description:i18n("xpack.graph.topNavMenu.settingsAriaLabel",{defaultMessage:"Settings"}),template:__webpack_require__(2035)});if($route.current.locals.savedWorkspace){var wsObj=JSON.parse($route.current.locals.savedWorkspace.wsState);$scope.savedWorkspace=$route.current.locals.savedWorkspace;$scope.description=$route.current.locals.savedWorkspace.description;wsObj.urlTemplates.forEach(function(urlTemplate){var encoder=$scope.outlinkEncoders.find(function(outlinkEncoder){return outlinkEncoder.id===urlTemplate.encoderID});if(encoder){var template={url:urlTemplate.url,description:urlTemplate.description,encoder:encoder};if(urlTemplate.iconClass){template.icon=_style_choices.drillDownIconChoicesByClass[urlTemplate.iconClass]}$scope.urlTemplates.push(template)}});var savedObjectIndexPattern=null;$scope.indices.forEach(function(savedObject){if(savedObject.attributes.title===wsObj.indexPattern){savedObjectIndexPattern=savedObject}});if(!savedObjectIndexPattern){_notify.toastNotifications.addDanger(i18n("xpack.graph.loadWorkspace.missingIndexPatternErrorMessage",{defaultMessage:"Missing index pattern {indexPattern}",values:{indexPattern:wsObj.indexPattern}}));return}$scope.indexSelected(savedObjectIndexPattern,function(){Object.assign($scope.exploreControls,wsObj.exploreControls);if($scope.exploreControls.sampleDiversityField){$scope.exploreControls.sampleDiversityField=$scope.allFields.find(function(field){return $scope.exploreControls.sampleDiversityField.name===field.name})}for(var i in wsObj.selectedFields){var savedField=wsObj.selectedFields[i];for(var f in $scope.allFields){var field=$scope.allFields[f];if(savedField.name===field.name){field.hopSize=savedField.hopSize;field.lastValidHopSize=savedField.lastValidHopSize;field.color=savedField.color;field.icon=$scope.iconChoicesByClass[savedField.iconClass];field.selected=true;$scope.selectedFields.push(field);break}}}$scope.updateLiveResponseFields();initWorkspaceIfRequired();var graph={nodes:[],edges:[]};for(var _i in wsObj.vertices){var vertex=wsObj.vertices[_i];var node={field:vertex.field,term:vertex.term,label:vertex.label,color:vertex.color,icon:$scope.allFields.filter(function(fieldDef){return vertex.field===fieldDef.name})[0].icon,data:{}};graph.nodes.push(node)}for(var _i2 in wsObj.blacklist){var vertex=wsObj.vertices[_i2];var fieldDef=$scope.allFields.filter(function(fieldDef){return vertex.field===fieldDef.name})[0];if(fieldDef){var _node={field:vertex.field,term:vertex.term,label:vertex.label,color:vertex.color,icon:fieldDef.icon,data:{field:vertex.field,term:vertex.term}};$scope.workspace.blacklistedNodes.push(_node)}}for(var _i3 in wsObj.links){var link=wsObj.links[_i3];graph.edges.push({source:link.source,target:link.target,inferred:link.inferred,label:link.label,term:vertex.term,width:link.width,weight:link.weight})}$scope.workspace.mergeGraph(graph);for(var _i4 in wsObj.vertices){var _vertex=wsObj.vertices[_i4];var vId=$scope.workspace.makeNodeId(_vertex.field,_vertex.term);var visNode=$scope.workspace.nodesMap[vId];visNode.x=_vertex.x;visNode.y=_vertex.y;if(_vertex.parent!==null){var parentSavedObj=graph.nodes[_vertex.parent];var parentId=$scope.workspace.makeNodeId(parentSavedObj.field,parentSavedObj.term);visNode.parent=$scope.workspace.nodesMap[parentId]}}$scope.workspace.runLayout();if($route.current.params.query){$scope.searchTerm=$route.current.params.query;$scope.submit()}})}else{$route.current.locals.SavedWorkspacesProvider.get().then(function(newWorkspace){$scope.savedWorkspace=newWorkspace})}$scope.saveWorkspace=function(){if($scope.allSavingDisabled){_notify.toastNotifications.addWarning(i18n("xpack.graph.saveWorkspace.disabledWarning",{defaultMessage:"Saving is disabled"}));return}initWorkspaceIfRequired();var canSaveData=$scope.graphSavePolicy==="configAndData"||$scope.graphSavePolicy==="configAndDataWithConsent"&&$scope.userHasConfirmedSaveWorkspaceData;var blacklist=[];var vertices=[];var links=[];if(canSaveData){blacklist=$scope.workspace.blacklistedNodes.map(function(node){return{x:node.x,y:node.y,field:node.data.field,term:node.data.term,label:node.label,color:node.color,parent:null,weight:node.weight,size:node.scaledSize}});vertices=$scope.workspace.nodes.map(function(node){return{x:node.x,y:node.y,field:node.data.field,term:node.data.term,label:node.label,color:node.color,parent:node.parent?$scope.workspace.nodes.indexOf(node.parent):null,weight:node.weight,size:node.scaledSize}});links=$scope.workspace.edges.map(function(edge){return{weight:edge.weight,width:edge.width,inferred:edge.inferred,label:edge.label,source:$scope.workspace.nodes.indexOf(edge.source),target:$scope.workspace.nodes.indexOf(edge.target)}})}var urlTemplates=$scope.urlTemplates.map(function(template){var result={url:template.url,description:template.description,encoderID:template.encoder.id};if(template.icon){result.iconClass=template.icon.class}return result});$scope.savedWorkspace.wsState=JSON.stringify({indexPattern:$scope.selectedIndex.attributes.title,selectedFields:$scope.selectedFields.map(function(field){return{name:field.name,lastValidHopSize:field.lastValidHopSize,color:field.color,iconClass:field.icon.class,hopSize:field.hopSize}}),blacklist:blacklist,vertices:vertices,links:links,urlTemplates:urlTemplates,exploreControls:$scope.exploreControls});$scope.savedWorkspace.numVertices=vertices.length;$scope.savedWorkspace.numLinks=links.length;$scope.savedWorkspace.description=$scope.description;$scope.savedWorkspace.save().then(function(id){$scope.kbnTopNav.close("save");$scope.userHasConfirmedSaveWorkspaceData=false;if(id){var title=i18n("xpack.graph.saveWorkspace.successNotificationTitle",{defaultMessage:'Saved "{workspaceTitle}"',values:{workspaceTitle:$scope.savedWorkspace.title}});var text=void 0;if(!canSaveData&&$scope.workspace.nodes.length>0){text=i18n("xpack.graph.saveWorkspace.successNotification.noDataSavedText",{defaultMessage:"The configuration was saved, but the data was not saved"})}_notify.toastNotifications.addSuccess({title:title,text:text,"data-test-subj":"saveGraphSuccess"});if($scope.savedWorkspace.id===$route.current.params.id)return;$scope.openSavedWorkspace($scope.savedWorkspace)}},_notify.fatalError)}})},2025:function(module,exports){module.exports='<div id="graphBasic" ng-controller="graphuiPlugin">\n  \x3c!-- Local nav. --\x3e\n  <kbn-top-nav name="workspacesTopNav" config="topNavMenu">\n    \x3c!-- Transcluded elements. --\x3e\n    <div data-transclude-slots>\n      \x3c!-- Title. --\x3e\n      <div data-transclude-slot="topLeftCorner" class="kuiLocalTitle">\n        <strong\n          ng-if="savedWorkspace.lastSavedTitle"\n        >{{ savedWorkspace.lastSavedTitle }}</strong>\n        <strong\n          ng-if="!savedWorkspace.lastSavedTitle"\n          i18n-id="xpack.graph.topNavMenu.defaultNewWorkspaceTitle"\n          i18n-default-message="New Graph Workspace"\n        ></strong>\n      </div>\n\n      <div data-transclude-slot="bottomRow" class="gphGraph__flexGroup">\n        \x3c!-- Select index pattern. --\x3e\n        <select class="form-control gphIndexSelect" name="mySelect" ng-change="uiSelectIndex()" ng-class="{\'gphIndexSelect-unselected\':selectedIndex === null}"\n          ng-options="option.attributes.title for option in indices" ng-model="grr.proposedIndex">\n          <option\n            value=""\n            i18n-id="xpack.graph.topNavMenu.selectIndexPatternOptionLabel"\n            i18n-default-message="Select index pattern…"\n          ></option>\n        </select>\n\n        \x3c!-- Added fields. --\x3e\n        <span\n          class="gphNoUserSelect"\n          ng-repeat="f in selectedFields"\n          ng-attr-tooltip="{{ ::\'xpack.graph.topNavMenu.addedFieldTooltip\' | i18n: {\n            defaultMessage: \'Shift + click to toggle if search returns {fName}\',\n            values: { fName: f.name }\n          } }}"\n        >\n          <svg class="gphNode" width="30" height="30" ng-click="clickVertexFieldIcon(f, $event)" ng-class="{\'gphNode-disabled\':f.hopSize<=0}">\n            <circle class="gphNode__circle" r="13" cx="15" cy="15" ng-class="{selectedNode:kbnTopNav.currentKey === \'fieldConfig\'&&f === selectedFieldConfig}"\n              ng-attr-style="fill:{{f.color}}" />\n            <text ng-if="f.icon" class="gphNode__text fa" text-anchor="middle" x="15" y="20">\n              {{f.icon.code}}\n            </text>\n          </svg>\n        </span>\n\n        \x3c!-- Add field button. --\x3e\n        <span\n          class="gphNoUserSelect"\n          ng-attr-tooltip="{{ ::\'xpack.graph.topNavMenu.addFieldButtonTooltip\' | i18n: { defaultMessage: \'Add a field source for vertices\' } }}"\n        >\n          <button\n            class="gphAddButton"\n            ng-disabled="selectedIndex === null"\n            aria-label="{{ ::\'xpack.graph.topNavMenu.addFieldButtonAriaLabel\' | i18n: { defaultMessage: \'Add a field\' } }}"\n            id="addVertexFieldButton"\n            ng-class="{\'gphAddButton-focus\':selectedIndex !== null&&selectedFields.length === 0}"\n            ng-click="toggleShowAdvancedFieldsConfig()"\n          >\n            <span aria-hidden="true" class="kuiIcon fa-plus"></span>\n          </button>\n        </span>\n\n        \x3c!-- Search. --\x3e\n        <form ng-submit="submit()" name="graphBasicSearch" class="gphGraph__flexGroupFiller" style="width: 100%">\n          <div class="kuiLocalSearch">\n            <input name="searchTerm" type="text" class="kuiLocalSearchInput" ng-model="grr.searchTerm" ng-disabled="liveResponseFields.length === 0"\n              ng-focus="kbnTopNav.close()" placeholder="foo AND bar NOT baz" autocomplete="off">\n            <button\n              class="kuiLocalSearchButton"\n              type="submit"\n              ng-disabled="liveResponseFields.length === 0"\n              aria-label="{{ ::\'xpack.graph.topNavMenu.searchButtonAriaLabel\' | i18n: { defaultMessage: \'Search\' } }}"\n            >\n              <span aria-hidden="true" class="kuiIcon fa-search"></span>\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </kbn-top-nav>\n\n  <div class="config" ng-show="kbnTopNav.currentKey === \'fields\'" data-test-subj="fieldSelectionList">\n    <div class="config">\n      <div class="container-fluid">\n        <label\n          i18n-id="xpack.graph.queryConfig.addFieldLabel"\n          i18n-default-message="Add a field source for vertices"\n        ></label>\n        <form>\n          <div class="input-group form-group" style="width:100%">\n            <span class="input-group-addon">\n              <span class="kuiIcon fa-search"></span>\n            </span>\n            <input\n              input-focus ng-model="fieldNamesFilterString"\n              placeholder="{{ ::\'xpack.graph.queryConfig.filterPlaceholder\' | i18n: { defaultMessage: \'Filter…\' } }}"\n              ng-change="filterFieldsKeyDown()"\n              class="form-control"\n              name="filter"\n              type="text"\n              autocomplete="off" />\n          </div>\n        </form>\n\n        <select class="kuiVerticalRhythm gphFieldList" id="fieldList" size="7" ng-options="item as item.name for item in filteredFields"\n          ng-dblclick="addFieldToSelection()" ng-model="selectedField"></select>\n\n        <div class="kuiVerticalRhythm">\n          \x3c!-- TODO look at the field chooser directive in Discover to give type icons etc to\n              field types. This may filter out indexed-only fields though? --\x3e\n          <button\n            ng-disabled="!selectedField"\n            ng-click="addFieldToSelection()"\n            class="kuiButton kuiButton--primary"\n            i18n-id="xpack.graph.queryConfig.addFieldButtonLabel"\n            i18n-default-message="Add"\n          ></button>\n        </div>\n      </div>\n\n      <button\n        class="kuiLocalDropdownCloseButton"\n        ng-click="kbnTopNav.close()"\n        aria-label="{{ ::\'xpack.graph.queryConfig.closeConfigButtonAriaLabel\' | i18n: { defaultMessage: \'Close\' } }}"\n      >\n        <span class="kuiIcon fa-chevron-circle-up"></span>\n      </button>\n    </div>\n  </div>\n\n  <div class="config" ng-show="kbnTopNav.currentKey === \'fieldConfig\'">\n    <div class="config">\n      <div class="container-fluid">\n\n        <div>\n          <form class="form-horizontal">\n\n            <div class="form-group">\n              <div class="col-sm-offset-4 col-sm-8">\n                <strong>{{selectedFieldConfig.name}}</strong>\n              </div>\n            </div>\n\n            <div class="form-group form-group-sm gphFormGroup--small">\n              <label\n                for="colorPicker"\n                class="col-sm-4 control-label"\n                i18n-id="xpack.graph.queryConfig.colorPickerLabel"\n                i18n-default-message="Color"\n              ></label>\n              <div class="col-sm-6">\n                <span id="colorPicker">\n                  <span ng-repeat="c in colors" ng-click="applyColor(selectedFieldConfig,c)" ng-class="c === selectedFieldConfig.color ? \'fa-circle-o\' : \'fa-circle\'"\n                    ng-style="{color: c}" class="kuiIcon gphColorPicker__color">\n                  </span>\n                </span>\n              </div>\n            </div>\n\n            <div class="form-group form-group-sm gphFormGroup--small">\n              <label\n                for="iconPicker"\n                class="col-sm-4 control-label"\n                i18n-id="xpack.graph.queryConfig.iconPickerLabel"\n                i18n-default-message="Icon"\n              ></label>\n              <div class="col-sm-6">\n                <span class="gphIconPicker">\n                  <span ng-repeat="i in iconChoices" ng-click="applyIcon(selectedFieldConfig,i)" ng-class="{selectedNode:i==selectedFieldConfig.icon}"\n                    class="kuiIcon gphIconPicker__icon gphNoUserSelect">\n                    {{i.code}}</span>\n                </span>\n              </div>\n            </div>\n\n            <div class="form-group form-group-sm gphFormGroup--small">\n              <label\n                for="qHopSize"\n                class="col-sm-4 control-label"\n                i18n-id="xpack.graph.queryConfig.maxTermsInputLabel"\n                i18n-default-message="Max terms per hop"\n              ></label>\n              <div class="col-sm-6">\n                <input ng-change="selectedFieldConfigHopSizeChanged()" type="number" class="input-sm" min="0" max="100"\n                  step="1" id="qHopSize" ng-model="selectedFieldConfig.hopSize">\n                <div class="help-block">\n                  <div class="euiText">\n                    <p\n                      i18n-id="xpack.graph.queryConfig.maxTermsInputDescription"\n                      i18n-default-message="Controls the number of terms returned each search step."\n                    ></p>\n                  </div>\n\n                  <div class="hintbox">\n                    <span class="kuiIcon fa-info text-info"></span>\n                    {{\n                      ::\'xpack.graph.queryConfig.maxTermsHelpText\' | i18n: {\n                        defaultMessage: \'Shift-clicking the field icons in the menu bar provides a quick way to toggle this number to zero and back\'\n                      }\n                    }}\n                  </div>\n\n                </div>\n              </div>\n            </div>\n\n            <div class="form-group">\n              <div class="col-sm-offset-4 col-sm-8">\n                <div>\n                  <button\n                    ng-click="removeVertexFieldSelection()"\n                    class="kuiButton kuiButton--danger"\n                    i18n-id="xpack.graph.queryConfig.removeFieldButtonLabel"\n                    i18n-default-message="Remove"\n                  ></button>\n                </div>\n              </div>\n            </div>\n\n          </form>\n\n        </div>\n\n\n      </div>\n\n      <div\n        class="kuiLocalDropdownCloseButton"\n        aria-label="{{ ::\'xpack.graph.queryConfig.closeAriaLabel\' | i18n: { defaultMessage: \'close\' } }}"\n        ng-click="kbnTopNav.close()"\n      >\n        <span class="kuiIcon fa-chevron-circle-up"></span>\n      </div>\n\n    </div>\n  </div>\n\n\n  <div class="gphGraph__container" id="GraphSvgContainer">\n    <svg class="gphGraph" width="100%" height="100%" pointer-events="all" id="graphSvg" ng-click="hideAllConfigPanels()">\n      <g id="svgRootGroup">\n        <g>\n          <line ng-repeat="edge in workspace.edges" class="edge" ng-attr-x1="{{edge.topSrc.kx}}" ng-attr-y1="{{edge.topSrc.ky}}"\n            ng-attr-x2="{{edge.topTarget.kx}}" ng-attr-y2="{{edge.topTarget.ky}}" ng-click="clickEdge(edge)" ng-class="{\'selectedEdge\':edge.isSelected, \'inferredEdge\':edge.inferred}"\n            ng-attr-style="stroke-width:{{edge.width}}px" stroke-linecap="round" />\n        </g>\n        <g ng-repeat="n in workspace.nodes" ng-if="!n.parent">\n          <circle class="gphNode__circle" ng-attr-r="{{n.scaledSize}}" ng-attr-cx="{{n.kx}}" ng-attr-cy="{{n.ky}}" ng-click="nodeClick(n, $event)"\n            ng-class="{selectedNode:n.isSelected}" ng-attr-style="fill:{{n.color}}" />\n          <text class="fa gphNode__text gphNode__text--lowOpacity" transform="translate(0,5)" text-anchor="middle" ng-attr-x="{{n.kx}}"\n            ng-attr-y="{{n.ky}}" ng-if="n.icon" ng-click="nodeClick(n, $event)">{{n.icon.code}}</text>\n\n          \x3c!-- Using 2 strategies for rendering labels - small text uses SVG for performance,\n            larger text uses HTML for word-wrapping capabilities but can be jittery.\n          --\x3e\n\n          <text ng-if="n.label.length<30" class="gphNode__label" text-anchor="middle" transform="translate(0,22)"\n            ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" ng-click="nodeClick(n, $event)">\n            {{n.label}}\n          </text>\n          <foreignObject ng-if="n.label.length>=30" width="100" height="20" transform="translate(-50,15)" ng-attr-x="{{n.kx}}"\n            ng-attr-y="{{n.ky}}" ng-click="nodeClick(n, $event)">\n\n            <body xmlns="http://www.w3.org/1999/xhtml">\n              <p class="gphNode__label gphNode__label--html gphNoUserSelect">{{n.label}}</p>\n            </body>\n          </foreignObject>\n\n          <g ng-if="n.numChildren>0">\n            <circle r="5" class="gphNode__markerCircle" transform="translate(10,10)" ng-attr-cx="{{n.kx}}" ng-attr-cy="{{n.ky}}"\n              ng-click="nodeClick(n, $event)" />\n            <text class="gphNode__markerText" text-anchor="middle" transform="translate(10,12)" ng-attr-x="{{n.kx}}"\n              ng-attr-y="{{n.ky}}" ng-click="nodeClick(n, $event)">{{n.numChildren}}\n            </text>\n\n          </g>\n        </g>\n      </g>\n    </svg>\n\n    \x3c!--\n            Experiment with group/ungroup buttons that reveal-on-zoom on nodes.\n\n     <g ng-if="workspace.selectedNodes.length>1||(workspace.selectedNodes.length>0&&workspace.selectedNodes[0] !== n)">\n      <g ng-if="zoomLevel>10" transform="translate(-1,-7)">\n        <rect class="SvgZoomedIconButton" ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" transform="translate(-1.5,-1.2)" ng-click="workspace.groupSelections(n)" width="6.5" height="2.2" rx="0.2" ry="0.2" />\n        <text class="SvgZoomedButtonText" transform="translate(3,0.3)" text-anchor="middle" ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" ng-click="workspace.groupSelections(n)">group</text>\n        <text class="SvgZoomedIconButtonText" transform="translate(-0.2,0.6)" text-anchor="middle" ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" ng-click="workspace.groupSelections(n)">&#xf247</text>\n      </g>\n    </g>\n    <g ng-if="zoomLevel>10" transform="translate(8,12.5)">\n      <rect class="SvgZoomedIconButton" ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" transform="translate(-1.5,-1.2)" ng-click="workspace.ungroup(n)" width="7" height="2" rx="0.2" ry="0.2" />\n      <text class="SvgZoomedButtonText" transform="translate(3,0.3)" text-anchor="middle" ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" ng-click="workspace.ungroup(n)">ungroup</text>\n      <text class="SvgZoomedIconButtonText" transform="translate(-0.4,0.6)" text-anchor="middle" ng-attr-x="{{n.kx}}" ng-attr-y="{{n.ky}}" ng-click="workspace.ungroup(n)">&#xf09c</text>\n    </g>\n\n  --\x3e\n\n    <div id="sidebar" class="gphSidebar" ng-if="workspace !== null">\n\n      <div>\n        <button\n          class="kuiButton kuiButton--basic kuiButton--small"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.undoButtonTooltip\' | i18n: { defaultMessage: \'Undo\' } }}"\n          type="button"\n          ng-click="workspace.undo()"\n          ng-disabled="workspace === null||workspace.undoLog.length <1"\n        >\n          <span class="kuiIcon fa-history"></span>\n        </button>\n\n        <button\n          class="kuiButton kuiButton--basic kuiButton--small"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.redoButtonTooltip\' | i18n: { defaultMessage: \'Redo\' } }}"\n          type="button"\n          ng-disabled="workspace === null ||workspace.redoLog.length === 0"\n          ng-click="workspace.redo()"\n        >\n          <span class="kuiIcon fa-repeat"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||liveResponseFields.length === 0||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.expandSelectionButtonTooltip\' | i18n: { defaultMessage: \'Expand selection\' } }}"\n          ng-click="setDetail(null);workspace.expandSelecteds({toFields:liveResponseFields});">\n          <span class="kuiIcon fa-plus"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.addLinksButtonTooltip\' | i18n: { defaultMessage: \'Add links between existing terms\' } }}"\n          ng-click="workspace.fillInGraph();">\n          <span class="kuiIcon fa-link"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.removeVerticesButtonTooltip\' | i18n: { defaultMessage: \'Remove vertices from workspace\' } }}"\n          ng-click="setDetail(null);workspace.deleteSelection();">\n          <span class="kuiIcon fa-trash"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.selectedNodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.blacklistButtonTooltip\' | i18n: { defaultMessage: \'Blacklist selection from return to workspace\' } }}"\n          ng-click="workspace.blacklistSelection();">\n          <span class="kuiIcon fa-ban"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null ||workspace.selectedNodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.customStyleButtonTooltip\' | i18n: { defaultMessage: \'Custom style selected vertices\' } }}"\n          ng-click="setDetail({showStyle:true})">\n          <span class="kuiIcon fa-paint-brush"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace === null||workspace.nodes.length === 0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.drillDownButtonTooltip\' | i18n: { defaultMessage: \'Drill down\' } }}"\n          ng-click="setDetail({showDrillDowns:true})">\n          <span class="kuiIcon fa-info"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-disabled="workspace.nodes.length === 0" ng-if="workspace.nodes.length === 0||workspace.force === null"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.runLayoutButtonTooltip\' | i18n: { defaultMessage: \'Run layout\' } }}"\n          ng-click="workspace.runLayout()">\n          <span class="kuiIcon fa-play"></span>\n        </button>\n\n        <button class="kuiButton kuiButton--basic kuiButton--small" ng-if="workspace.force !== null&&workspace.nodes.length>0"\n          tooltip="{{ ::\'xpack.graph.sidebar.topMenu.pauseLayoutButtonTooltip\' | i18n: { defaultMessage: \'Pause layout\' } }}"\n          ng-click="workspace.stopLayout()">\n          <span class="kuiIcon fa-pause"></span>\n        </button>\n      </div>\n\n      <div>\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-shopping-cart"></span>\n          {{ ::\'xpack.graph.sidebar.selectionsTitle\' | i18n: { defaultMessage: \'Selections\' } }}\n        </div>\n\n        <div id="vertexSelectionTypesBar">\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.selectAllButtonTooltip\' | i18n: { defaultMessage: \'Select all\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.nodes.length === 0" ng-click="setDetail(null);workspace.selectAll()"\n            i18n-id="xpack.graph.sidebar.selections.selectAllButtonLabel"\n            i18n-default-message="all"\n          ></button>\n\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.selectNoneButtonTooltip\' | i18n: { defaultMessage: \'Select none\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.nodes.length === 0" ng-click="setDetail(null);workspace.selectNone()"\n            i18n-id="xpack.graph.sidebar.selections.selectNoneButtonLabel"\n            i18n-default-message="none"\n          ></button>\n\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.invertSelectionButtonTooltip\' | i18n: { defaultMessage: \'Invert selection\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.nodes.length === 0" ng-click="setDetail(null);workspace.selectInvert()"\n            i18n-id="xpack.graph.sidebar.selections.invertSelectionButtonLabel"\n            i18n-default-message="invert"\n          ></button>\n\n          <button\n            tooltip="{{ ::\'xpack.graph.sidebar.selections.selectNeighboursButtonTooltip\' | i18n: { defaultMessage: \'Select neighbours\' } }}"\n            type="button" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n            ng-disabled="workspace.selectedNodes.length === 0" ng-click="setDetail(null);workspace.selectNeighbours()"\n            i18n-id="xpack.graph.sidebar.selections.selectNeighboursButtonLabel"\n            i18n-default-message="linked"\n          ></button>\n        </div>\n\n        <div class="gphSelectionList">\n          <p\n            ng-if="workspace.selectedNodes.length === 0"\n            class="help-block"\n            i18n-id="xpack.graph.sidebar.selections.noSelectionsHelpText"\n            i18n-default-message="No selections. Click on vertices to add"\n          ></p>\n\n          <div ng-repeat="n in workspace.selectedNodes" class="gphSelectionList__field" ng-class="{\'gphSelectionList__field--selected\': isSelectedSelected(n)}"\n            ng-click="selectSelected(n)">\n            <svg width="24" height="24">\n              <circle class="gphNode__circle " r="10" cx="12" cy="12" ng-attr-style="fill:{{n.color}}"\n                ng-click="workspace.deselectNode(n)" />\n\n              <text ng-if="n.icon" class="fa gphNode__text" text-anchor="middle" x="12" y="17" ng-click="workspace.deselectNode(n)">{{n.icon.code}}</text>\n            </svg>\n            <span>{{n.label}}</span>\n            <span ng-if="n.numChildren>0"> (+{{n.numChildren}})</span>\n\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- Any drill-downs with a choice of button icon appear here for quick access --\x3e\n      <div ng-if="(urlTemplates | filter:{icon: {class:\'\'}}).length > 0">\n        <button ng-repeat="urlTemplate in urlTemplates  | filter:{icon: {class:\'\'}}" class="kuiButton kuiButton--basic kuiButton--small gphVertexSelect__button"\n          tooltip="{{urlTemplate.description}}" type="button" ng-disabled="workspace === null ||workspace.nodes.length === 0"\n          ng-click="openUrlTemplate(urlTemplate)">\n          <span class="kuiIcon" ng-class="urlTemplate.icon.class"></span>\n        </button>\n      </div>\n\n      <div ng-if="detail.showDrillDowns">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-info"></span>\n          {{ ::\'xpack.graph.sidebar.drillDownsTitle\' | i18n: { defaultMessage: \'Drill-downs\' } }}\n        </div>\n\n        <div class="gphSidebar__panel">\n          <p\n            ng-if="urlTemplates.length === 0"\n            class="help-block"\n            i18n-id="xpack.graph.sidebar.drillDowns.noDrillDownsHelpText"\n            i18n-default-message="Configure drill-downs from the settings menu"\n          ></p>\n\n          <ul class="list-group">\n            <li class="list-group-item" ng-repeat="urlTemplate in urlTemplates">\n              <span ng-if="urlTemplate.icon" class="kuiIcon gphNoUserSelect">\n                {{urlTemplate.icon.code}}</span>\n              <a ng-click="openUrlTemplate(urlTemplate)">{{urlTemplate.description}}</a>\n            </li>\n          </ul>\n        </div>\n      </div>\n\n      <div class="gphSidebar__panel" ng-if="(detail.showStyle)&&(workspace.selectedNodes.length>0)">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-paint-brush"></span>\n          {{ ::\'xpack.graph.sidebar.styleVerticesTitle\' | i18n: { defaultMessage: \'Style selected vertices\' } }}\n        </div>\n\n        <div class="form-group form-group-sm gphFormGroup--small">\n          <span ng-repeat="c in colors" ng-disabled="!selectedField.selected" ng-click="workspace.colorSelected(c)"\n            ng-style="{color: c}" class="kuiIcon gphColorPicker__color fa-circle">\n          </span>\n        </div>\n      </div>\n\n      <div class="gphSidebar__panel" ng-if="detail.latestNodeSelection">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon {{detail.latestNodeSelection.icon.class}}" ng-if="detail.latestNodeSelection.icon"></span>\n          {{detail.latestNodeSelection.data.field}} {{detail.latestNodeSelection.data.term}}\n        </div>\n\n        <button\n          class="kuiButton kuiButton--basic kuiButton--iconText kuiButton--small"\n          ng-if="workspace.selectedNodes.length>1||(workspace.selectedNodes.length>0&&workspace.selectedNodes[0] !== detail.latestNodeSelection)"\n          tooltip="{{ \'xpack.graph.sidebar.groupButtonTooltip\' | i18n: {\n            defaultMessage: \'group the currently selected items into {latestSelectionLabel}\',\n            values: { latestSelectionLabel: detail.latestNodeSelection.label },\n          } }}"\n          ng-click="workspace.groupSelections(detail.latestNodeSelection)"\n        >\n          <span class="kuiButton__icon kuiIcon fa-object-group"></span>\n          <span\n            i18n-id="xpack.graph.sidebar.groupButtonLabel"\n            i18n-default-message="group"\n          ></span>\n        </button>\n\n        <button\n          class="kuiButton kuiButton--basic kuiButton--iconText kuiButton--small"\n          ng-if="detail.latestNodeSelection.numChildren>0"\n          tooltip="{{ \'xpack.graph.sidebar.ungroupButtonTooltip\' | i18n: {\n            defaultMessage: \'ungroup {latestSelectionLabel}\',\n            values: { latestSelectionLabel: detail.latestNodeSelection.label },\n          } }}"\n          ng-click="workspace.ungroup(detail.latestNodeSelection)"\n        >\n          <span class="kuiIcon fa-object-ungroup"></span>\n          <span\n            i18n-id="xpack.graph.sidebar.ungroupButtonLabel"\n            i18n-default-message="ungroup"\n          ></span>\n        </button>\n\n        <form class="form-horizontal">\n          <div class="form-group form-group-sm gphFormGroup--small">\n            <label\n              for="labelEdit"\n              class="col-sm-3 control-label"\n              i18n-id="xpack.graph.sidebar.displayLabelLabel"\n              i18n-default-message="Display label"\n            ></label>\n            <div class="col-sm-9">\n              <input type="text" id="labelEdit" class="form-control input-sm" ng-model="detail.latestNodeSelection.label">\n              <div\n                class="help-block"\n                i18n-id="xpack.graph.sidebar.displayLabelHelpText"\n                i18n-default-message="Change the label for this vertex"\n              ></div>\n            </div>\n          </div>\n        </form>\n      </div>\n\n      <div ng-if="detail.mergeCandidates.length>0" class="gphSidebar__panel">\n        <div class="gphSidebar__header">\n          <span class="kuiIcon fa-link"></span>\n          {{ ::\'xpack.graph.sidebar.linkSummaryTitle\' | i18n: { defaultMessage: \'Link summary\' } }}\n        </div>\n        <div ng-repeat="mc in detail.mergeCandidates">\n          <span>\n            <button\n              tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.mergeTerm1ToTerm2ButtonTooltip\' | i18n: {\n                  defaultMessage: \'Merge {term1} into {term2}\',\n                  values: { term1: mc.term1, term2: mc.term2 },\n                } }}"\n              type="button" ng-attr-style="opacity:{{0.2+(mc.overlap/mc.v1)}};"\n              class="kuiButton kuiButton--basic kuiButton--small" ng-click="performMerge(mc.id2, mc.id1)">\n              <span class="kuiIcon fa-chevron-circle-right"></span>\n            </button>\n\n            <span class="gphLinkSummary__term--1">{{mc.term1}}</span>\n            <span class="gphLinkSummary__term--2">{{mc.term2}}</span>\n\n            <button\n              tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.mergeTerm2ToTerm1ButtonTooltip\' | i18n: {\n                defaultMessage: \'Merge {term2} into {term1}\',\n                values: { term1: mc.term1, term2: mc.term2 },\n              } }}"\n              type="button" class="kuiButton kuiButton--basic kuiButton--small"\n              ng-attr-style="opacity:{{0.2+(mc.overlap/mc.v2)}};" ng-click="performMerge(mc.id1, mc.id2)">\n              <span class="kuiIcon fa-chevron-circle-left"></span>\n            </button>\n          </span>\n\n          \x3c!-- Venn diagram of term/shared doc intersections --\x3e\n          <div class="gphLinkSummary__venn" venn="mc"></div>\n\n          <small\n            class="gphLinkSummary__term--1"\n            tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.leftTermCountTooltip\' | i18n: {\n              defaultMessage: \'{count} documents have term {term}\',\n              values: { count: mc.v1, term: mc.term1 },\n            } }}"\n          >{{mc.v1}}</small>\n          <small\n            class="gphLinkSummary__term--1-2"\n            tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.bothTermsCountTooltip\' | i18n: {\n              defaultMessage: \'{count} documents have both terms\',\n              values: { count: mc.overlap },\n            } }}"\n          >&nbsp;({{mc.overlap}})&nbsp;</small>\n          <small\n            class="gphLinkSummary__term--2"\n            tooltip="{{ ::\'xpack.graph.sidebar.linkSummary.rightTermCountTooltip\' | i18n: {\n              defaultMessage: \'{count} documents have term {term}\',\n              values: { count: mc.v2, term: mc.term2 },\n            } }}"\n          >{{mc.v2}}</small>\n        </div>\n\n\n\n        <div class="gphSidebar__panel" ng-if="(detail.inferredEdge)">\n          <div class="gphSidebar__header">\n            <span class="kuiIcon fa-cog"></span>\n            {{ ::\'xpack.graph.sidebar.similarLabelsTitle\' | i18n: { defaultMessage: \'Similar labels\' } }}\n          </div>\n\n          <div class="form-group form-group-sm gphFormGroup--small">\n            <div style="line-height: 24px;">\n              <button\n                tooltip="{{ ::\'xpack.graph.sidebar.similarLabels.mergeTargetToSrcButtonTooltip\' | i18n: {\n                  defaultMessage: \'Merge {targetLabel} into {srcLabel}\',\n                  values: { targetLabel: detail.inferredEdge.topTarget.label, srcLabel: detail.inferredEdge.topSrc.label },\n                } }}"\n                type="button" style="vertical-align: top;" class="kuiButton kuiButton--basic kuiButton--small"\n                ng-click="performMerge(detail.inferredEdge.topTarget.id, detail.inferredEdge.topSrc.id)">\n                <span class="kui fa-chevron-circle-down"></span>\n              </button>\n              <svg width="24" height="24">\n                <circle class="gphNode__circle " r="10" cx="12" cy="12" ng-attr-style="fill:{{detail.inferredEdge.topSrc.color}}" />\n\n                <text ng-if="detail.inferredEdge.topSrc.icon" class="fa gphNode__text" text-anchor="middle" x="12" y="16">{{detail.inferredEdge.topSrc.icon.code}}</text>\n              </svg>\n              <span style="vertical-align: top;">{{detail.inferredEdge.topSrc.label}}</span>\n            </div>\n            <div style="line-height: 24px;">\n              <button\n                tooltip="{{ ::\'xpack.graph.sidebar.similarLabels.mergeSrcToTargetButtonTooltip\' | i18n: {\n                  defaultMessage: \'Merge {srcLabel} into {targetLabel}\',\n                  values: { targetLabel: detail.inferredEdge.topTarget.label, srcLabel: detail.inferredEdge.topSrc.label },\n                } }}"\n                type="button" style="vertical-align: top;" class="kuiButton kuiButton--basic kuiButton--small"\n                ng-click="performMerge(detail.inferredEdge.topSrc.id, detail.inferredEdge.topTarget.id)">\n                <span class="kuiIcon fa-chevron-circle-up"></span>\n              </button>\n\n              <svg width="24" height="24">\n                <circle class="gphNode__circle " r="10" cx="12" cy="12" ng-attr-style="fill:{{detail.inferredEdge.topTarget.color}}" />\n\n                <text ng-if="detail.inferredEdge.topTarget.icon" class="fa gphNode__text" text-anchor="middle" x="12" y="16">{{detail.inferredEdge.topTarget.icon.code}}</text>\n              </svg>\n              <span style="vertical-align: top;">{{detail.inferredEdge.topTarget.label}}</span>\n\n            </div>\n\n            <div\n              class="col-sm-10"\n              i18n-id="xpack.graph.sidebar.similarLabels.keyTermsText"\n              i18n-default-message="Key terms: {inferredEdgeLabel}"\n              i18n-values="{ html_inferredEdgeLabel: \'<small>\' + detail.inferredEdge.label + \'</small>\' }"\n            ></div>\n          </div>\n        </div>\n      </div>\n      \x3c!-- end edge-merge detail panel --\x3e\n\n    </div>\n    \x3c!-- end sidebar --\x3e\n\n  </div>\n  \x3c!--end svg container--\x3e\n\n</div>\n'},2026:function(module,exports,__webpack_require__){"use strict";var _d=__webpack_require__(21);var _d2=_interopRequireDefault(_d);var _venn=__webpack_require__(1094);var _modules=__webpack_require__(6);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_modules.uiModules.get("app/graph").directive("venn",function(){return{scope:{venn:"=",vennKey:"=?",vennKeySize:"=?",vennMap:"=?"},restrict:"AE",controller:function controller($scope,$element){$scope.$watch("venn",function(){var element=$element[0];while(element.firstChild){element.removeChild(element.firstChild)}var params=$scope.venn;if(!params){return}var height=params.height?params.height:"50px";var width=params.width?params.width:"200px";var v1=params.v1?params.v1:10;var v2=params.v2?params.v2:10;var overlap=params.overlap?params.overlap:5;var v1Class=params.v1Class?params.v1Class:"venn1";var v2Class=params.v2Class?params.v2Class:"venn2";var r1=Math.sqrt(v1/Math.PI);var r2=Math.sqrt(v2/Math.PI);var maxR=Math.max(r1,r2);var x1=r1;var y1=maxR;var x2=x1+(0,_venn.distanceFromIntersectArea)(r1,r2,overlap);var y2=maxR;var imageWidth=maxR*4;var blankRight=imageWidth-(x2+r2);x1+=blankRight/2;x2+=blankRight/2;var viewBoxDims="0 0 "+imageWidth+" "+maxR*2;var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");svg.setAttribute("width",width);svg.setAttribute("height",height);svg.setAttribute("viewBox",viewBoxDims);var g=document.createElementNS("http://www.w3.org/2000/svg","g");var circle1=document.createElementNS("http://www.w3.org/2000/svg","ellipse");circle1.setAttribute("cx",x1);circle1.setAttribute("cy",y1);circle1.setAttribute("rx",r1);circle1.setAttribute("ry",r1);circle1.setAttribute("class",v1Class);g.appendChild(circle1);var circle2=document.createElementNS("http://www.w3.org/2000/svg","ellipse");circle2.setAttribute("cx",x2);circle2.setAttribute("cy",y2);circle2.setAttribute("rx",r2);circle2.setAttribute("ry",r2);circle2.setAttribute("class",v2Class);g.appendChild(circle2);svg.appendChild(g);element.appendChild(svg)},true)}}})},2027:function(module,exports,__webpack_require__){"use strict";var d3=__webpack_require__(21);module.exports=function(){var graphExplorer=function graphExplorer(indexName,typeName,request,responseHandler){var dataForServer=JSON.stringify(request);$.ajax({type:"POST",url:"http://localhost:9200/"+indexName+"/_xpack/graph/_explore",dataType:"json",contentType:"application/json;charset=utf-8",async:true,data:dataForServer,success:function success(data){responseHandler(data)}})};var searcher=function searcher(indexName,request,responseHandler){var dataForServer=JSON.stringify(request);$.ajax({type:"POST",url:"http://localhost:9200/"+indexName+"/_search?rest_total_hits_as_int=true",dataType:"json",contentType:"application/json;charset=utf-8",async:true,data:dataForServer,success:function success(data){responseHandler(data)}})};function AddNodeOperation(node,owner){var self=this;var vm=owner;self.node=node;self.undo=function(){vm.arrRemove(vm.nodes,self.node);vm.arrRemove(vm.selectedNodes,self.node);self.node.isSelected=false;delete vm.nodesMap[self.node.id]};self.redo=function(){vm.nodes.push(self.node);vm.nodesMap[self.node.id]=self.node}}function AddEdgeOperation(edge,owner){var self=this;var vm=owner;self.edge=edge;self.undo=function(){vm.arrRemove(vm.edges,self.edge);delete vm.edgesMap[self.edge.id]};self.redo=function(){vm.edges.push(self.edge);vm.edgesMap[self.edge.id]=self.edge}}function ReverseOperation(operation){var self=this;var reverseOperation=operation;self.undo=reverseOperation.redo;self.redo=reverseOperation.undo}function GroupOperation(receiver,orphan,vm){var self=this;self.receiver=receiver;self.orphan=orphan;self.undo=function(){self.orphan.parent=undefined};self.redo=function(){self.orphan.parent=self.receiver}}function UnGroupOperation(parent,child,vm){var self=this;self.parent=parent;self.child=child;self.undo=function(){self.child.parent=self.parent};self.redo=function(){self.child.parent=undefined}}function createWorkspace(options){return new GraphWorkspace(options)}function GraphWorkspace(options){var self=this;this.blacklistedNodes=[];this.options=options;this.undoLog=[];this.redoLog=[];this.selectedNodes=[];if(!options){this.options={}}this.nodesMap={};this.edgesMap={};this.searchTerm="";this.seqNumber=0;this.nodes=[];this.edges=[];this.lastRequest=null;this.lastResponse=null;this.changeHandler=options.changeHandler;if(options.graphExploreProxy){graphExplorer=options.graphExploreProxy}if(options.searchProxy){searcher=options.searchProxy}this.addUndoLogEntry=function(undoOperations){self.undoLog.push(undoOperations);if(self.undoLog.length>50){self.undoLog.splice(0,1)}self.redoLog=[]};this.undo=function(){var lastOps=this.undoLog.pop();if(lastOps){this.stopLayout();this.redoLog.push(lastOps);for(var i in lastOps){lastOps[i].undo()}this.runLayout()}};this.redo=function(){var lastOps=this.redoLog.pop();if(lastOps){this.stopLayout();this.undoLog.push(lastOps);for(var i in lastOps){lastOps[i].redo()}this.runLayout()}};this.areLinked=function(a,b){if(a==b)return true;var allEdges=this.edges;for(var e in allEdges){if(e.source==a){if(e.target==b){return true}}if(e.source==b){if(e.target==a){return true}}}return false};this.selectAll=function(){self.selectedNodes=[];for(var n in self.nodes){var node=self.nodes[n];if(node.parent==undefined){node.isSelected=true;self.selectedNodes.push(node)}else{node.isSelected=false}}};this.selectNone=function(){self.selectedNodes=[];for(var n in self.nodes){var node=self.nodes[n];node.isSelected=false}};this.selectInvert=function(){self.selectedNodes=[];for(var n in self.nodes){var node=self.nodes[n];if(node.parent!=undefined){continue}node.isSelected=!node.isSelected;if(node.isSelected){self.selectedNodes.push(node)}}};this.selectNodes=function(nodes){for(var n in nodes){var node=nodes[n];node.isSelected=true;if(self.selectedNodes.indexOf(node)<0){self.selectedNodes.push(node)}}};this.selectNode=function(node){node.isSelected=true;if(self.selectedNodes.indexOf(node)<0){self.selectedNodes.push(node)}};this.deleteSelection=function(){var allAndGrouped=self.returnUnpackedGroupeds(self.selectedNodes);if(allAndGrouped.length==0){allAndGrouped=self.nodes.slice(0)}var undoOperations=[];for(var i in allAndGrouped){var node=allAndGrouped[i];node.isSelected=false;delete self.nodesMap[node.id];undoOperations.push(new ReverseOperation(new AddNodeOperation(node,self)))}self.arrRemoveAll(self.nodes,allAndGrouped);self.arrRemoveAll(self.selectedNodes,allAndGrouped);var danglingEdges=self.edges.filter(function(edge){return self.nodes.indexOf(edge.source)<0||self.nodes.indexOf(edge.target)<0});for(var _i in danglingEdges){var edge=danglingEdges[_i];delete self.edgesMap[edge.id];undoOperations.push(new ReverseOperation(new AddEdgeOperation(edge,self)))}self.addUndoLogEntry(undoOperations);self.arrRemoveAll(self.edges,danglingEdges);self.runLayout()};this.selectNeighbours=function(){var newSelections=[];for(var n in self.edges){var edge=self.edges[n];if(!edge.topSrc.isSelected){if(self.selectedNodes.indexOf(edge.topTarget)>=0){if(newSelections.indexOf(edge.topSrc)<0){newSelections.push(edge.topSrc)}}}if(!edge.topTarget.isSelected){if(self.selectedNodes.indexOf(edge.topSrc)>=0){if(newSelections.indexOf(edge.topTarget)<0){newSelections.push(edge.topTarget)}}}}for(var i in newSelections){var newlySelectedNode=newSelections[i];self.selectedNodes.push(newlySelectedNode);newlySelectedNode.isSelected=true}};this.selectNone=function(){for(var n in self.selectedNodes){self.selectedNodes[n].isSelected=false}self.selectedNodes=[]};this.deselectNode=function(node){node.isSelected=false;self.arrRemove(self.selectedNodes,node)};this.getAllSelectedNodes=function(){return this.returnUnpackedGroupeds(self.selectedNodes)};this.colorSelected=function(colorNum){var selections=self.getAllSelectedNodes();for(var i in selections){selections[i].color=colorNum}};this.getSelectionsThatAreGrouped=function(){var result=[];var selections=self.selectedNodes;for(var i in selections){var node=selections[i];if(node.numChildren>0){result.push(node)}}return result};this.ungroupSelection=function(){var selections=self.getSelectionsThatAreGrouped();for(var i in selections){var node=selections[i];self.ungroup(node)}};this.toggleNodeSelection=function(node){if(node.isSelected){self.deselectNode(node)}else{node.isSelected=true;self.selectedNodes.push(node)}return node.isSelected};this.returnUnpackedGroupeds=function(topLevelNodeArray){var result=topLevelNodeArray.slice();var edges=this.edges;for(var i=0;i<edges.length;i++){var edge=edges[i];var topLevelSource=edge.topSrc;var topLevelTarget=edge.topTarget;if(result.indexOf(topLevelTarget)>=0){var target=edge.target;while(target.parent!=undefined){if(result.indexOf(target)<0){result.push(target)}target=target.parent}}if(result.indexOf(topLevelSource)>=0){var source=edge.source;while(source.parent!=undefined){if(result.indexOf(source)<0){result.push(source)}source=source.parent}}}return result};this.clearGraph=function(){this.stopLayout();this.nodes=[];this.edges=[];this.undoLog=[];this.redoLog=[];this.nodesMap={};this.edgesMap={};this.blacklistedNodes=[];this.selectedNodes=[];this.lastResponse=null};this.arrRemoveAll=function remove(arr,items){for(var i=items.length;i--;){self.arrRemove(arr,items[i])}};this.arrRemove=function remove(arr,item){for(var i=arr.length;i--;){if(arr[i]===item){arr.splice(i,1)}}};this.getNeighbours=function(node){var neighbourNodes=[];for(var e in self.edges){var edge=self.edges[e];if(edge.topSrc==edge.topTarget){continue}if(edge.topSrc==node){if(neighbourNodes.indexOf(edge.topTarget)<0){neighbourNodes.push(edge.topTarget)}}if(edge.topTarget==node){if(neighbourNodes.indexOf(edge.topSrc)<0){neighbourNodes.push(edge.topSrc)}}}return neighbourNodes};this.buildNodeQuery=function(topLevelNode){var containedNodes=[topLevelNode];containedNodes=self.returnUnpackedGroupeds(containedNodes);if(containedNodes.length==1){var tq={};tq[topLevelNode.data.field]=topLevelNode.data.term;return{term:tq}}var termsByField={};for(var i in containedNodes){var node=containedNodes[i];var termsList=termsByField[node.data.field];if(!termsList){termsList=[];termsByField[node.data.field]=termsList}termsList.push(node.data.term)}if(Object.keys(termsByField).length==1){return{terms:termsByField}}var q={bool:{should:[]}};for(var field in termsByField){var _tq={};_tq[field]=termsByField[field];q.bool.should.push({terms:_tq})}return q};this.stopLayout=function(){if(this.force){this.force.stop()}this.force=null};this.runLayout=function(){this.stopLayout();var effectiveEdges=[];var edges=self.edges;for(var e in edges){var edge=edges[e];var topSrc=edge.source;var topTarget=edge.target;while(topSrc.parent!=undefined){topSrc=topSrc.parent}while(topTarget.parent!=undefined){topTarget=topTarget.parent}edge.topSrc=topSrc;edge.topTarget=topTarget;if(topSrc!=topTarget){effectiveEdges.push({source:topSrc,target:topTarget})}}var visibleNodes=self.nodes.filter(function(n){return n.parent==undefined});var allNodes=self.nodes;for(var n in allNodes){var node=allNodes[n];node.numChildren=0}for(var _n in allNodes){var _node=allNodes[_n];while(_node.parent!=undefined){_node=_node.parent;_node.numChildren=_node.numChildren+1}}this.force=d3.layout.force().nodes(visibleNodes).links(effectiveEdges).friction(.8).linkDistance(100).charge(-1500).gravity(.15).theta(.99).alpha(.5).size([800,600]).on("tick",function(e){var nodeArray=self.nodes;var hasRollups=false;for(var i in nodeArray){var _n2=nodeArray[i];if(_n2.parent==undefined){_n2.kx=_n2.x;_n2.ky=_n2.y}else{hasRollups=true}}if(hasRollups){for(var _i2 in nodeArray){var _n3=nodeArray[_i2];if(_n3.parent!=undefined){var topLevelNode=_n3.parent;while(topLevelNode.parent!=undefined){topLevelNode=topLevelNode.parent}_n3.kx=topLevelNode.x;_n3.ky=topLevelNode.y}}}if(self.changeHandler){self.changeHandler()}});this.force.start()};this.groupSelections=function(node){var ops=[];self.nodes.forEach(function(otherNode){if(otherNode!=node&&otherNode.isSelected&&otherNode.parent==undefined){otherNode.parent=node;otherNode.isSelected=false;self.arrRemove(self.selectedNodes,otherNode);ops.push(new GroupOperation(node,otherNode,self))}});self.selectNone();self.selectNode(node);self.addUndoLogEntry(ops);self.runLayout()};this.mergeNeighbours=function(node){var neighbours=self.getNeighbours(node);var ops=[];neighbours.forEach(function(otherNode){if(otherNode!=node&&otherNode.parent==undefined){otherNode.parent=node;otherNode.isSelected=false;self.arrRemove(self.selectedNodes,otherNode);ops.push(new GroupOperation(node,otherNode,self))}});self.addUndoLogEntry(ops);self.runLayout()};this.mergeSelections=function(targetNode){if(!targetNode){console.log("Error - merge called on undefined target");return}var selClone=self.selectedNodes.slice();var ops=[];selClone.forEach(function(otherNode){if(otherNode!=targetNode&&otherNode.parent==undefined){otherNode.parent=targetNode;otherNode.isSelected=false;self.arrRemove(self.selectedNodes,otherNode);ops.push(new GroupOperation(targetNode,otherNode,self))}});self.addUndoLogEntry(ops);self.runLayout()};this.ungroup=function(node){var ops=[];self.nodes.forEach(function(other){if(other.parent==node){other.parent=undefined;ops.push(new UnGroupOperation(node,other,self))}});self.addUndoLogEntry(ops);self.runLayout()};this.unblacklist=function(node){self.arrRemove(self.blacklistedNodes,node)};this.blacklistSelection=function(){var selection=self.getAllSelectedNodes();var danglingEdges=[];self.edges.forEach(function(edge){if(selection.indexOf(edge.source)>=0||selection.indexOf(edge.target)>=0){delete self.edgesMap[edge.id];danglingEdges.push(edge)}});for(var n in selection){var node=selection[n];delete self.nodesMap[node.id];self.blacklistedNodes.push(node);node.isSelected=false}self.arrRemoveAll(self.nodes,selection);self.arrRemoveAll(self.edges,danglingEdges);self.selectedNodes=[];self.runLayout()};this.simpleSearch=function(searchTerm,fieldsChoice,numHops){var qs={query_string:{query:searchTerm}};return this.search(qs,fieldsChoice,numHops)};this.search=function(query,fieldsChoice,numHops){if(!fieldsChoice){fieldsChoice=self.options.vertex_fields}var step={};var excludeNodesByField={};var nots=[];var avoidNodes=this.blacklistedNodes;for(var i=0;i<avoidNodes.length;i++){var n=avoidNodes[i];var arr=excludeNodesByField[n.data.field];if(!arr){arr=[];excludeNodesByField[n.data.field]=arr}arr.push(n.data.term);var tq={};tq[n.data.field]=n.data.term;nots.push({term:tq})}var rootStep=step;for(var hopNum=0;hopNum<numHops;hopNum++){var _arr=[];for(var f in fieldsChoice){var field=fieldsChoice[f].name;var hopSize=fieldsChoice[f].hopSize;var excludes=excludeNodesByField[field];var stepField={field:field,size:hopSize,min_doc_count:parseInt(self.options.exploreControls.minDocCount)};if(excludes){stepField.exclude=excludes}_arr.push(stepField)}step.vertices=_arr;if(hopNum<numHops-1){var nextStep={};step.connections=nextStep;step=nextStep}}if(nots.length>0){query={bool:{must:[query],must_not:nots}}}var request={query:query,controls:self.buildControls(),connections:rootStep.connections,vertices:rootStep.vertices};self.callElasticsearch(request)};this.buildControls=function(){var guiSettingsObj=self.options.exploreControls;var controls={use_significance:guiSettingsObj.useSignificance,sample_size:guiSettingsObj.sampleSize,timeout:parseInt(guiSettingsObj.timeoutMillis)};if(guiSettingsObj.sampleDiversityField!=null){controls.sample_diversity={field:guiSettingsObj.sampleDiversityField.name,max_docs_per_value:guiSettingsObj.maxValuesPerDoc}}return controls};this.makeNodeId=function(field,term){return field+".."+term};this.makeEdgeId=function(srcId,targetId){var id=srcId+"->"+targetId;if(srcId>targetId){id=targetId+"->"+srcId}return id};this.mergeGraph=function(newData){this.stopLayout();if(!newData.nodes){newData.nodes=[]}var lastOps=[];var dedupedNodes=[];for(var o in newData.nodes){var node=newData.nodes[o];node.id=self.makeNodeId(node.field,node.term);if(!this.nodesMap[node.id]){if(!node.label){node.label=node.term}dedupedNodes.push(node)}}if(dedupedNodes.length>0&&this.options.nodeLabeller){this.options.nodeLabeller(dedupedNodes)}for(var _o in dedupedNodes){var dedupedNode=dedupedNodes[_o];var label=dedupedNode.term;if(dedupedNode.label){label=dedupedNode.label}var _node2={x:1,y:1,numChildren:0,parent:undefined,isSelected:false,id:dedupedNode.id,label:label,color:dedupedNode.color,icon:dedupedNode.icon,data:dedupedNode};_node2.scaledSize=15;_node2.seqNumber=this.seqNumber++;this.nodes.push(_node2);lastOps.push(new AddNodeOperation(_node2,self));this.nodesMap[_node2.id]=_node2}for(var _o2 in newData.edges){var edge=newData.edges[_o2];var src=newData.nodes[edge.source];var target=newData.nodes[edge.target];edge.id=this.makeEdgeId(src.id,target.id);var srcWrapperObj=this.nodesMap[src.id];var targetWrapperObj=this.nodesMap[target.id];var existingEdge=this.edgesMap[edge.id];if(existingEdge){existingEdge.weight=Math.max(existingEdge.weight,edge.weight);existingEdge.doc_count=Math.max(existingEdge.doc_count,edge.doc_count);continue}var inferred=edge.inferred?true:false;var newEdge={source:srcWrapperObj,target:targetWrapperObj,weight:edge.weight,width:edge.width,id:edge.id,doc_count:edge.doc_count,inferred:inferred};if(edge.label){newEdge.label=edge.label}this.edgesMap[newEdge.id]=newEdge;this.edges.push(newEdge);lastOps.push(new AddEdgeOperation(newEdge,self))}if(lastOps.length>0){self.addUndoLogEntry(lastOps)}this.runLayout()};this.mergeIds=function(parentId,childId){var parent=self.getNode(parentId);var child=self.getNode(childId);if(child.isSelected){child.isSelected=false;self.arrRemove(self.selectedNodes,child)}child.parent=parent;self.addUndoLogEntry([new GroupOperation(parent,child,self)]);self.runLayout()};this.getNode=function(nodeId){return this.nodesMap[nodeId]};this.getEdge=function(edgeId){return this.edgesMap[edgeId]};this.expandSelecteds=function(){var targetOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var startNodes=self.getAllSelectedNodes();if(startNodes.length==0){startNodes=self.nodes}var clone=startNodes.slice();self.expand(clone,targetOptions)};this.expandGraph=function(){self.expandSelecteds()};this.expandNode=function(node){self.expand(self.returnUnpackedGroupeds([node]),{})};this.expand=function(startNodes,targetOptions){var nodesByField={};var excludeNodesByField={};var avoidNodes=this.blacklistedNodes;for(var i=0;i<avoidNodes.length;i++){var n=avoidNodes[i];var arr=excludeNodesByField[n.data.field];if(!arr){arr=[];excludeNodesByField[n.data.field]=arr}if(arr.indexOf(n.data.term)<0){arr.push(n.data.term)}}var allExistingNodes=this.nodes;for(var _i3=0;_i3<allExistingNodes.length;_i3++){var _n4=allExistingNodes[_i3];var _arr2=excludeNodesByField[_n4.data.field];if(!_arr2){_arr2=[];excludeNodesByField[_n4.data.field]=_arr2}_arr2.push(_n4.data.term)}for(var _i4=0;_i4<startNodes.length;_i4++){var _n5=startNodes[_i4];var _arr3=nodesByField[_n5.data.field];if(!_arr3){_arr3=[];nodesByField[_n5.data.field]=_arr3}_arr3.push({term:_n5.data.term,boost:_n5.data.weight});_arr3=excludeNodesByField[_n5.data.field];if(!_arr3){_arr3=[];excludeNodesByField[_n5.data.field]=_arr3}if(_arr3.indexOf(_n5.data.term)<0){_arr3.push(_n5.data.term)}}var primaryVertices=[];var secondaryVertices=[];for(var fieldName in nodesByField){primaryVertices.push({field:fieldName,include:nodesByField[fieldName],min_doc_count:parseInt(self.options.exploreControls.minDocCount)})}var targetFields=this.options.vertex_fields;if(targetOptions.toFields){targetFields=targetOptions.toFields}for(var f in targetFields){var _fieldName=targetFields[f].name;var hopSize=targetFields[f].hopSize>0?targetFields[f].hopSize:targetFields[f].lastValidHopSize;var fieldHop={field:_fieldName,size:hopSize,min_doc_count:parseInt(self.options.exploreControls.minDocCount)};fieldHop.exclude=excludeNodesByField[_fieldName];secondaryVertices.push(fieldHop)}var request={controls:self.buildControls(),vertices:primaryVertices,connections:{vertices:secondaryVertices}};self.lastRequest=JSON.stringify(request,null,"\t");graphExplorer(self.options.indexName,request,function(data){self.lastResponse=JSON.stringify(data,null,"\t");var nodes=[];var edges=[];for(var _n6 in data.vertices){var node=data.vertices[_n6];for(var _f in targetFields){var fieldDef=targetFields[_f];if(node.field==fieldDef.name){node.color=fieldDef.color;node.icon=fieldDef.icon;node.fieldDef=fieldDef;break}}}var minLineSize=2;var maxLineSize=10;var maxEdgeWeight=1e-8;for(var e in data.connections){var edge=data.connections[e];maxEdgeWeight=Math.max(maxEdgeWeight,edge.weight)}for(var _e in data.connections){var _edge=data.connections[_e];edges.push({source:_edge.source,target:_edge.target,doc_count:_edge.doc_count,weight:_edge.weight,width:Math.max(minLineSize,_edge.weight/maxEdgeWeight*maxLineSize)})}self.mergeGraph({nodes:data.vertices,edges:edges})})};this.trimExcessNewEdges=function(newNodes,newEdges){var trimmedEdges=[];var maxNumEdgesToReturn=5;for(var o in newEdges){var edge=newEdges[o];var src=newNodes[edge.source];var target=newNodes[edge.target];var srcId=src.field+".."+src.term;var targetId=target.field+".."+target.term;var id=this.makeEdgeId(srcId,targetId);var existingSrcNode=self.nodesMap[srcId];var existingTargetNode=self.nodesMap[targetId];if(existingSrcNode!=null&&existingTargetNode!=null){if(existingSrcNode.parent!=undefined&&existingTargetNode.parent!=undefined){continue}}else{console.log("Error? Missing nodes "+srcId+" or "+targetId,self.nodesMap);continue}var existingEdge=self.edgesMap[id];if(existingEdge){existingEdge.weight=Math.max(existingEdge.weight,edge.weight);existingEdge.doc_count=Math.max(existingEdge.doc_count,edge.doc_count);continue}else{trimmedEdges.push(edge)}}if(trimmedEdges.length>maxNumEdgesToReturn){trimmedEdges.sort(function(a,b){return b.weight-a.weight});trimmedEdges=trimmedEdges.splice(0,maxNumEdgesToReturn)}return trimmedEdges};this.getQuery=function(startNodes,loose){var shoulds=[];var nodes=startNodes;if(!startNodes){nodes=self.nodes}for(var bs in nodes){var node=nodes[bs];if(node.parent==undefined){shoulds.push(self.buildNodeQuery(node))}}return{bool:{should:shoulds,minimum_should_match:Math.min(shoulds.length,loose?1:2)}}};this.getSelectedOrAllNodes=function(){var startNodes=self.getAllSelectedNodes();if(startNodes.length===0){startNodes=self.nodes}return startNodes};this.getSelectedOrAllTopNodes=function(){return self.getSelectedOrAllNodes().filter(function(node){return node.parent===undefined})};function addTermToFieldList(map,field,term){var arr=map[field];if(!arr){arr=[];map[field]=arr}arr.push(term)}this.fillInGraph=function(){var nodesForLinking=self.getSelectedOrAllTopNodes();var maxNewEdges=10;var maxNumVerticesSearchable=100;if(nodesForLinking.length>maxNumVerticesSearchable){for(var i=0;i<maxNumVerticesSearchable;i++){var oldNode=nodesForLinking[i];var randomIndex=Math.floor(Math.random()*(nodesForLinking.length-i))+i;nodesForLinking[i]=nodesForLinking[randomIndex];nodesForLinking[randomIndex]=oldNode}nodesForLinking=nodesForLinking.slice(0,maxNumVerticesSearchable-1)}var shoulds=[];var filterMap={};nodesForLinking.forEach(function(node,nodeNum){var nodeQuery=self.buildNodeQuery(node);shoulds.push(nodeQuery);filterMap[nodeNum]=nodeQuery});var searchReq={size:0,query:{bool:{minimum_should_match:2,should:shoulds}},aggs:{matrix:{adjacency_matrix:{separator:"|",filters:filterMap}}}};searcher(self.options.indexName,searchReq,function(data){var numDocsMatched=data.hits.total;var buckets=data.aggregations.matrix.buckets;var vertices=nodesForLinking.map(function(existingNode){return{field:existingNode.data.field,term:existingNode.data.term,weight:1,depth:0}});var connections=[];var maxEdgeWeight=0;var keyedBuckets={};buckets.forEach(function(bucket){keyedBuckets[bucket.key]=bucket});buckets.forEach(function(bucket){var ids=bucket.key.split("|");if(ids.length===2){if(self.options.exploreControls.useSignificance){var t1=keyedBuckets[ids[0]].doc_count;var t2=keyedBuckets[ids[1]].doc_count;var t1AndT2=bucket.doc_count;bucket.weight=self.JLHScore(t1AndT2,Math.max(t1,t2),Math.min(t1,t2),numDocsMatched)}else{bucket.weight=bucket.doc_count}maxEdgeWeight=Math.max(maxEdgeWeight,bucket.weight)}});var backFilledMinLineSize=2;var backFilledMaxLineSize=5;buckets.forEach(function(bucket){if(bucket.doc_count<parseInt(self.options.exploreControls.minDocCount)){return}var ids=bucket.key.split("|");if(ids.length==2){var srcNode=nodesForLinking[ids[0]];var targetNode=nodesForLinking[ids[1]];var edgeId=self.makeEdgeId(srcNode.id,targetNode.id);var existingEdge=self.edgesMap[edgeId];if(existingEdge){existingEdge.doc_count=Math.max(existingEdge.doc_count,bucket.doc_count)}else{connections.push({source:parseInt(ids[0]),target:parseInt(ids[1]),weight:bucket.weight,width:Math.max(backFilledMinLineSize,bucket.weight/maxEdgeWeight*backFilledMaxLineSize),doc_count:bucket.doc_count})}}});if(connections.length>maxNewEdges){connections=connections.sort(function(a,b){return b.weight-a.weight});connections=connections.slice(0,maxNewEdges)}self.mergeGraph({nodes:vertices,edges:connections})})};this.getLikeThisButNotThisQuery=function(startNodes){var likeQueries=[];var txtsByFieldType={};startNodes.forEach(function(node){var txt=txtsByFieldType[node.data.field];if(txt){txt=txt+" "+node.label}else{txt=node.label}txtsByFieldType[node.data.field]=txt});for(var field in txtsByFieldType){likeQueries.push({more_like_this:{like:txtsByFieldType[field],min_term_freq:1,minimum_should_match:"20%",min_doc_freq:1,boost_terms:2,max_query_terms:25}})}var excludeNodesByField={};var allExistingNodes=self.nodes;allExistingNodes.forEach(function(existingNode){addTermToFieldList(excludeNodesByField,existingNode.data.field,existingNode.data.term)});var blacklistedNodes=self.blacklistedNodes;blacklistedNodes.forEach(function(blacklistedNode){addTermToFieldList(excludeNodesByField,blacklistedNode.data.field,blacklistedNode.data.term)});var notExistingNodes=[];Object.keys(excludeNodesByField).forEach(function(fieldName){var termsQuery={};termsQuery[fieldName]=excludeNodesByField[fieldName];notExistingNodes.push({terms:termsQuery})});var result={boosting:{negative_boost:1e-4,negative:{bool:{should:notExistingNodes}},positive:{bool:{should:likeQueries}}}};return result};this.getSelectedIntersections=function(callback){if(self.selectedNodes.length==0){return self.getAllIntersections(callback,self.nodes)}if(self.selectedNodes.length==1){var selectedNode=self.selectedNodes[0];var neighbourNodes=self.getNeighbours(selectedNode);neighbourNodes.push(selectedNode);return self.getAllIntersections(callback,neighbourNodes)}return self.getAllIntersections(callback,self.getAllSelectedNodes())};this.JLHScore=function(subsetFreq,subsetSize,supersetFreq,supersetSize){var subsetProbability=subsetFreq/subsetSize;var supersetProbability=supersetFreq/supersetSize;var absoluteProbabilityChange=subsetProbability-supersetProbability;if(absoluteProbabilityChange<=0){return 0}var relativeProbabilityChange=subsetProbability/supersetProbability;return absoluteProbabilityChange*relativeProbabilityChange};this.getAllIntersections=function(callback,nodes){nodes=nodes.filter(function(n){return n.parent==undefined});var allQueries=nodes.map(function(node){return self.buildNodeQuery(node)});var allQuery={bool:{should:allQueries}};var request={query:allQuery,size:0,aggs:{all:{global:{}},sources:{filters:{filters:{}},aggs:{targets:{filters:{filters:{}}}}}}};for(var n in allQueries){request.aggs.sources.filters.filters["bg"+n]=allQueries[n];request.aggs.sources.aggs.targets.filters.filters["fg"+n]=allQueries[n]}var dataForServer=JSON.stringify(request);searcher(self.options.indexName,request,function(data){var termIntersects=[];var fullDocCounts=[];var allDocCount=data.aggregations.all.doc_count;for(var _n7 in nodes){fullDocCounts.push(data.aggregations.sources.buckets["bg"+_n7].doc_count)}for(var _n8 in nodes){var rootNode=nodes[_n8];var t1=fullDocCounts[_n8];var baseAgg=data.aggregations.sources.buckets["bg"+_n8].targets.buckets;for(var l in nodes){var t2=fullDocCounts[l];var leafNode=nodes[l];if(l==_n8){continue}if(t1>t2){continue}if(t1==t2){if(rootNode.id>leafNode.id){continue}}var t1AndT2=baseAgg["fg"+l].doc_count;if(t1AndT2==0){continue}var neighbourNode=nodes[l];var t1Label=rootNode.data.label;if(rootNode.numChildren>0){t1Label+="(+"+rootNode.numChildren+")"}var t2Label=neighbourNode.data.label;if(neighbourNode.numChildren>0){t2Label+="(+"+neighbourNode.numChildren+")"}var mergeConfidence=self.JLHScore(t1AndT2,t2,t1,allDocCount);var termIntersect={id1:rootNode.id,id2:neighbourNode.id,term1:t1Label,term2:t2Label,v1:t1,v2:t2,mergeLeftConfidence:t1AndT2/t1,mergeRightConfidence:t1AndT2/t2,mergeConfidence:mergeConfidence,overlap:t1AndT2};termIntersects.push(termIntersect)}}termIntersects.sort(function(a,b){if(b.mergeConfidence!=a.mergeConfidence){return b.mergeConfidence-a.mergeConfidence}if(b.overlap!=a.overlap){return b.overlap-a.overlap}return a.v2-b.v2});if(callback){callback(termIntersects)}})};this.callElasticsearch=function(request){self.lastRequest=JSON.stringify(request,null,"\t");graphExplorer(self.options.indexName,request,function(data){self.lastResponse=JSON.stringify(data,null,"\t");var nodes=[];var edges=[];for(var n in data.vertices){var node=data.vertices[n];for(var f in self.options.vertex_fields){var fieldDef=self.options.vertex_fields[f];if(node.field==fieldDef.name){node.color=fieldDef.color;node.icon=fieldDef.icon;node.fieldDef=fieldDef;break}}}var minLineSize=2;var maxLineSize=10;var maxEdgeWeight=1e-8;for(var e in data.connections){var edge=data.connections[e];maxEdgeWeight=Math.max(maxEdgeWeight,edge.weight)}for(var _e2 in data.connections){var _edge2=data.connections[_e2];edges.push({source:_edge2.source,target:_edge2.target,doc_count:_edge2.doc_count,weight:_edge2.weight,width:Math.max(minLineSize,_edge2.weight/maxEdgeWeight*maxLineSize)})}self.mergeGraph({nodes:data.vertices,edges:edges},{labeller:self.options.labeller})})}}return{createWorkspace:createWorkspace}}()},2028:function(module,exports,__webpack_require__){"use strict";var venn=__webpack_require__(1094);module.exports=function(){function unwrapFieldNames(obj,path,fields){if(!obj.properties){return}for(var p in obj.properties){var child=obj.properties[p];if(child.properties){path.push(p);unwrapFieldNames(child,path,fields);path.pop()}else{var parentName="";for(var i in path){parentName+=path[i];parentName+="."}fields.push({name:parentName+p,path:path.slice(0),leafName:p});if(child.fields){for(var mfield in child.fields){fields.push({name:parentName+p+"."+mfield,path:path.slice(0),leafName:p})}}}}}function getMergeSuggestionObjects(termIntersects){var mergeCandidates=[];for(var i in termIntersects){var ti=termIntersects[i];mergeCandidates.push({id1:ti.id1,id2:ti.id2,term1:ti.term1,term2:ti.term2,v1:ti.v1,v2:ti.v2,overlap:ti.overlap,width:100,height:60})}return mergeCandidates}return{unwrapFieldNames:unwrapFieldNames,getMergeSuggestionObjects:getMergeSuggestionObjects}}()},2029:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SavedWorkspacesProvider=SavedWorkspacesProvider;var _lodash=__webpack_require__(2);var _lodash2=_interopRequireDefault(_lodash);var _modules=__webpack_require__(6);var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _saved_object_registry=__webpack_require__(257);var _saved_objects=__webpack_require__(50);var _i18n=__webpack_require__(4);var _saved_workspace=__webpack_require__(2030);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SavedWorkspacesProvider(kbnUrl,Private,Promise){var savedObjectsClient=Private(_saved_objects.SavedObjectsClientProvider);var SavedWorkspace=Private(_saved_workspace.SavedWorkspaceProvider);this.type=SavedWorkspace.type;this.Class=SavedWorkspace;this.loaderProperties={name:"Graph workspace",noun:_i18n.i18n.translate("xpack.graph.savedWorkspaces.graphWorkspaceLabel",{defaultMessage:"Graph workspace"}),nouns:_i18n.i18n.translate("xpack.graph.savedWorkspaces.graphWorkspacesLabel",{defaultMessage:"Graph workspaces"})};this.get=function(id){return new SavedWorkspace(id).init()};this.urlFor=function(id){return _chrome2.default.addBasePath(kbnUrl.eval("/app/graph#/workspace/{{id}}",{id:id}))};this.delete=function(ids){ids=!_lodash2.default.isArray(ids)?[ids]:ids;return Promise.map(ids,function(id){return new SavedWorkspace(id).delete()})};this.mapHits=function(hit){var source=hit.attributes;source.id=hit.id;source.url=this.urlFor(hit.id);source.icon="fa-share-alt";return source};this.find=function(searchString){var _this=this;var size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;var body=void 0;if(searchString){body={query:{simple_query_string:{query:searchString+"*",fields:["title^3","description"],default_operator:"AND"}}}}else{body={query:{match_all:{}}}}return savedObjectsClient.find({type:SavedWorkspace.type,search:searchString?searchString+"*":undefined,perPage:size,searchFields:["title^3","description"]}).then(function(resp){return{total:resp.total,hits:resp.savedObjects.map(function(hit){return _this.mapHits(hit)})}})}}_modules.uiModules.get("app/graph").service("savedGraphWorkspaces",function(Private){return Private(SavedWorkspacesProvider)});_saved_object_registry.SavedObjectRegistryProvider.register(SavedWorkspacesProvider)},2030:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SavedWorkspaceProvider=SavedWorkspaceProvider;var _modules=__webpack_require__(6);var _courier=__webpack_require__(176);var _i18n=__webpack_require__(4);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var _module=_modules.uiModules.get("app/dashboard");function SavedWorkspaceProvider(Private){var SavedObject=Private(_courier.SavedObjectProvider);var SavedWorkspace=function(_SavedObject){_inherits(SavedWorkspace,_SavedObject);function SavedWorkspace(id){_classCallCheck(this,SavedWorkspace);var _this=_possibleConstructorReturn(this,(SavedWorkspace.__proto__||Object.getPrototypeOf(SavedWorkspace)).call(this,{type:SavedWorkspace.type,mapping:SavedWorkspace.mapping,searchSource:SavedWorkspace.searchsource,id:id,defaults:{title:_i18n.i18n.translate("xpack.graph.savedWorkspace.workspaceNameTitle",{defaultMessage:"New Graph Workspace"}),numLinks:0,numVertices:0,wsState:"{}",version:1}}));_this.getDisplayName=function(){return"graph workspace"};return _this}return SavedWorkspace}(SavedObject);SavedWorkspace.type="graph-workspace";SavedWorkspace.mapping={title:"text",description:"text",numLinks:"integer",numVertices:"integer",version:"integer",wsState:"json"};SavedWorkspace.searchsource=false;return SavedWorkspace}_module.factory("SavedGraphWorkspace",function(Private){return Private(SavedWorkspaceProvider)})},2031:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var iconChoices=exports.iconChoices=[{class:"fa-folder-open-o",code:"",patterns:[/category/i,/folder/i,/group/i]},{class:"fa-cube",code:"",patterns:[/prod/i,/sku/i]},{class:"fa-key",code:"",patterns:[/key/i]},{class:"fa-bank",code:"",patterns:[/bank/i,/account/i]},{class:"fa-automobile",code:"",patterns:[/car/i,/veh/i]},{class:"fa-home",code:"",patterns:[/address/i,/home/i]},{class:"fa-question",code:"",patterns:[/query/i,/search/i]},{class:"fa-plane",code:"",patterns:[/flight/i,/plane/i]},{class:"fa-file-o",code:"",patterns:[/file/i,/doc/i]},{class:"fa-user",code:"",patterns:[/user/i,/person/i,/people/i,/owner/i,/cust/i,/participant/i,/party/i,/member/i]},{class:"fa-users",code:"",patterns:[/group/i,/team/i,/meeting/i]},{class:"fa-music",code:"",patterns:[/artist/i,/sound/i,/music/i]},{class:"fa-flag",code:"",patterns:[/country/i,/warn/i,/flag/i]},{class:"fa-tag",code:"",patterns:[/tag/i,/label/i]},{class:"fa-phone",code:"",patterns:[/phone/i]},{class:"fa-desktop",code:"",patterns:[/host/i,/server/i]},{class:"fa-font",code:"",patterns:[/text/i,/title/i,/body/i,/desc/i]},{class:"fa-at",code:"",patterns:[/account/i,/email/i]},{class:"fa-heart",code:"",patterns:[/like/i,/favourite/i,/favorite/i]},{class:"fa-bolt",code:"",patterns:[/action/i]},{class:"fa-map-marker",code:"",patterns:[/location/i,/geo/i,/position/i]},{class:"fa-exclamation",code:"",patterns:[/risk/i,/error/i,/warn/i]},{class:"fa-industry",code:"",patterns:[/business/i,/company/i,/industry/i,/organisation/i]}];var iconChoicesByClass=exports.iconChoicesByClass={};iconChoices.forEach(function(icon){iconChoicesByClass[icon.class]=icon});var drillDownIconChoices=exports.drillDownIconChoices=[{class:"fa-line-chart",code:""},{class:"fa-pie-chart",code:""},{class:"fa-area-chart",code:""},{class:"fa-bar-chart",code:""},{class:"fa-globe",code:""},{class:"fa-file-text-o",code:""},{class:"fa-google",code:""},{class:"fa-eye",code:""},{class:"fa-tachometer",code:""},{class:"fa-info",code:""},{class:"fa-external-link",code:""},{class:"fa-table",code:""},{class:"fa-list",code:""},{class:"fa-share-alt",code:""}];var drillDownIconChoicesByClass=exports.drillDownIconChoicesByClass={};drillDownIconChoices.forEach(function(icon){drillDownIconChoicesByClass[icon.class]=icon});var colorChoices=exports.colorChoices=["#99bde7","#e3d754","#8ee684","#e7974c","#e4878d","#67adab","#43ebcc","#e4b4ea","#a1a655","#78b36e"]},2032:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getOutlinkEncoders=undefined;var _risonNode=__webpack_require__(238);var _risonNode2=_interopRequireDefault(_risonNode);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var getOutlinkEncoders=exports.getOutlinkEncoders=function getOutlinkEncoders(i18n){return[{id:"esq-rison-loose",title:i18n("xpack.graph.outlinkEncoders.esqRisonLooseTitle",{defaultMessage:"elasticsearch OR query (rison encoded)"}),description:i18n("xpack.graph.outlinkEncoders.esqRisonLooseDescription",{defaultMessage:"rison-encoded JSON, minimum_should_match=1, compatible with most Kibana URLs"}),encode:function encode(workspace){return encodeURIComponent(_risonNode2.default.encode(workspace.getQuery(workspace.getSelectedOrAllNodes(),true)))}},{id:"esq-rison",title:i18n("xpack.graph.outlinkEncoders.esqRisonTitle",{defaultMessage:"elasticsearch AND query (rison encoded)"}),description:i18n("xpack.graph.outlinkEncoders.esqRisonDescription",{defaultMessage:"rison-encoded JSON, minimum_should_match=2, compatible with most Kibana URLs"}),encode:function encode(workspace){return encodeURIComponent(_risonNode2.default.encode(workspace.getQuery(workspace.getSelectedOrAllNodes())))}},{id:"esq-similar-rison",title:i18n("xpack.graph.outlinkEncoders.esqSimilarRisonTitle",{defaultMessage:"elasticsearch more like this query (rison encoded)"}),description:i18n("xpack.graph.outlinkEncoders.esqSimilarRisonDescription",{defaultMessage:'rison-encoded JSON, "like this but not this" type query to find missing docs'}),encode:function encode(workspace){return encodeURIComponent(_risonNode2.default.encode(workspace.getLikeThisButNotThisQuery(workspace.getSelectedOrAllNodes())))}},{id:"esq-plain",title:i18n("xpack.graph.outlinkEncoders.esqPlainTitle",{defaultMessage:"elasticsearch query (plain encoding)"}),description:i18n("xpack.graph.outlinkEncoders.esqPlainDescription",{defaultMessage:"JSON encoded using standard url encoding"}),encode:function encode(workspace){return encodeURIComponent(JSON.stringify(workspace.getQuery(workspace.getSelectedOrAllNodes())))}},{id:"text-plain",title:i18n("xpack.graph.outlinkEncoders.textPlainTitle",{defaultMessage:"plain text"}),description:i18n("xpack.graph.outlinkEncoders.textPlainDescription",{defaultMessage:"Text of selected vertex labels as a plain url-encoded string"}),encode:function encode(workspace){var q="";var nodes=workspace.getSelectedOrAllNodes();for(var i=0;i<nodes.length;i++){var node=nodes[i];if(i>0){q+=" "}q+=node.label}return encodeURIComponent(q)}},{id:"text-lucene",title:i18n("xpack.graph.outlinkEncoders.textLuceneTitle",{defaultMessage:"Lucene-escaped text"}),description:i18n("xpack.graph.outlinkEncoders.textLuceneDescription",{defaultMessage:"Text of selected vertex labels with any Lucene special characters encoded"}),encode:function encode(workspace){var q="";var nodes=workspace.getSelectedOrAllNodes();for(var i=0;i<nodes.length;i++){var node=nodes[i];if(i>0){q+=" "}q+=node.label}var luceneChars='+-&|!(){}[]^"~*?:\\';q=q.split("").map(function(char){return luceneChars.includes(char)?"\\"+char:char}).join("");return encodeURIComponent(q)}}]}},2033:function(module,exports){module.exports='<form ng-submit="saveWorkspace()" role="form">\n  <div\n    class="kuiLocalDropdownTitle"\n    i18n-id="xpack.graph.topNavMenu.save.saveWorkspaceTitle"\n    i18n-default-message="Save Workspace"\n  ></div>\n  <div class="form-group">\n    <label\n      for="workspaceTitle"\n      i18n-id="xpack.graph.topNavMenu.save.nameInputLabel"\n      i18n-default-message="Name"\n    ></label>\n    <input id="workspaceTitle" type="text" ng-model="savedWorkspace.title" class="form-control"\n      placeholder="{{ ::\'xpack.graph.topNavMenu.save.nameInputPlaceholder\' | i18n: { defaultMessage: \'Graph workspace name\' } }}"\n      input-focus="select"\n    >\n  </div>\n  <saved-object-save-as-check-box saved-object="savedWorkspace"></saved-object-save-as-check-box>\n  <div class="form-group">\n    <label\n      for="workspaceTitle"\n      i18n-id="xpack.graph.topNavMenu.save.descriptionInputLabel"\n      i18n-default-message="Description"\n    ></label>\n    <textarea\n      class="form-control input-sm" rows="5" id="notesEdit"\n      placeholder="{{ ::\'xpack.graph.topNavMenu.save.descriptionInputPlaceholder\' | i18n: { defaultMessage: \'Any notes..\' } }}"\n      ng-model="grr.description"\n    ></textarea>\n  </div>\n  <div class="text-warning " ng-if="workspace.nodes.length>0 && !grr.userHasConfirmedSaveWorkspaceData && graphSavePolicy==\'configAndDataWithConsent\'">\n    <i class="fa fa-warning"></i>\n    {{ ::\'xpack.graph.topNavMenu.save.saveConfigurationOnlyWarning\' | i18n: {\n      defaultMessage: \'The data in this workspace will be cleared and only the configuration will be saved\',\n    } }}\n  </div>\n  <div class="gphNoUserSelect checkbox" ng-if="graphSavePolicy==\'configAndDataWithConsent\'">\n    <label>\n      <input type="checkbox" ng-model="grr.userHasConfirmedSaveWorkspaceData">\n      {{ ::\'xpack.graph.topNavMenu.save.saveGraphContentCheckboxLabel\' | i18n: { defaultMessage: \'Save Graph Content\' } }}\n    </label>\n  </div>\n\n  <button\n    type="submit"\n    ng-disabled="!savedWorkspace.title"\n    class="kuiButton kuiButton--primary"\n    aria-label="{{ ::\'xpack.graph.topNavMenu.save.confirmButtonAriaLabel\' | i18n: { defaultMessage: \'Save workspace\' } }}"\n    i18n-id="xpack.graph.topNavMenu.save.confirmButtonLabel"\n    i18n-default-message="Save"\n  ></button>\n\n  <div ng-if="workspace.nodes.length>0 && graphSavePolicy==\'config\'">\n    <span class="text-info" >\n      <i class="fa fa-info"></i>\n      {{ ::\'xpack.graph.topNavMenu.save.saveConfigurationOnlyText\' | i18n: {\n        defaultMessage: \'The data in this workspace will be cleared and only the configuration will be saved\',\n      } }}\n    </span>\n  </div>\n\n</form>\n'},2034:function(module,exports){module.exports='<div\n  class="kuiLocalDropdownTitle"\n  i18n-id="xpack.graph.topNavMenu.open.openWorkspaceTitle"\n  i18n-default-message="Open Workspace"\n></div>\n\n<saved-object-finder\n  title="{{ ::\'xpack.graph.topNavMenu.open.workspacesListTooltip\' | i18n: { defaultMessage: \'Saved Workspaces\' } }}"\n  type="Graph workspace"\n  use-local-management="true"\n  on-choose="openSavedWorkspace"\n></saved-object-finder>\n'},2035:function(module,exports){module.exports='<div\n  class="kuiLocalDropdownTitle"\n  i18n-id="xpack.graph.topNavMenu.settingsTitle"\n  i18n-default-message="Settings"\n></div>\n\n\n\x3c!-- ====== start tabs ====== --\x3e\n<ul class="nav nav-tabs" ng-show="selectedIndex !== null">\n  <li ng-show="workspace" ng-class="{active: configPanel === \'lastRequest\'}" >\n    <a\n      ng-click="configPanel=\'lastRequest\'"\n      class="navbar-link"\n      i18n-id="xpack.graph.settings.lastRequestTitle"\n      i18n-default-message="Last request"\n    ></a>\n  </li>\n\n  <li ng-show="workspace" ng-class="{active: configPanel ===\'blacklist\'}">\n    <a\n      ng-click="configPanel=\'blacklist\'"\n      class="navbar-link"\n      i18n-id="xpack.graph.settings.blacklistTitle"\n      i18n-default-message="Blacklist"\n    ></a>\n  </li>\n\n  <li ng-class="{active: configPanel === \'settings\'}">\n    <a\n      ng-click="configPanel=\'settings\'"\n      class="navbar-link"\n      i18n-id="xpack.graph.settings.advancedSettingsTitle"\n      i18n-default-message="Advanced settings"\n    ></a>\n  </li>\n\n  <li ng-show="canEditDrillDownUrls" ng-class="{active: configPanel === \'drillDowns\'}" >\n    <a\n      ng-click="configPanel=\'drillDowns\'"\n      class="navbar-link"\n      i18n-id="xpack.graph.settings.drillDownsTitle"\n      i18n-default-message="Drill-downs"\n    ></a>\n  </li>\n</ul>\n\x3c!-- ====== stop tabs ====== --\x3e\n\n\n\x3c!-- ====== start spy tab content ====== --\x3e\n<div\n  class="list-group-item list-group-item--noBorder"\n  ng-if="(workspace !== null) && (configPanel === \'lastRequest\')"\n>\n  <small class="help-block">http://host:port/{{selectedIndex.name}}/_xpack/graph/_explore</small>\n  <ul class="nav nav-tabs">\n    <li ng-class="{active: spymode === \'request\'}">\n      <a\n        ng-click="spymode=\'request\'"\n        i18n-id="xpack.graph.settings.lastRequest.requestTabTitle"\n        i18n-default-message="Request"\n      ></a>\n    </li>\n    <li ng-class="{active: spymode === \'response\'}">\n      <a\n        ng-click="spymode=\'response\'"\n        i18n-id="xpack.graph.settings.lastRequest.responseTabTitle"\n        i18n-default-message="Response"\n      ></a>\n    </li>\n  </ul>\n\n  <div\n    ng-show="spymode == \'request\'"\n    ui-ace="{ onLoad: aceLoaded, mode: \'json\', advanced: { readOnly: true } }"\n    ng-model="workspace.lastRequest"\n    class="gphSettings__jsonView"\n  ></div>\n  <div\n    ng-show="spymode == \'response\'"\n    ui-ace="{ onLoad: aceLoaded, mode: \'json\', advanced: { readOnly: true } }"\n    ng-model="workspace.lastResponse"\n    class="gphSettings__jsonView"\n  ></div>\n</div>\n\x3c!-- ====== end spy tab content ====== --\x3e\n\n\n\x3c!-- ====== start term blacklist tab content ====== --\x3e\n<div\n  class="list-group-item list-group-item--noBorder"\n  ng-if="(workspace!==null) && (configPanel===\'blacklist\')"\n>\n  <p\n    class="help-block"\n    i18n-id="xpack.graph.settings.blacklist.blacklistHelpText"\n    i18n-default-message="These terms are currently blacklisted from re-appearing in the workspace"\n  ></p>\n\n  <div class="gphSelectionList kuiVerticalRhythm">\n    \x3c!-- ====== start terms ====== --\x3e\n    <div\n      ng-repeat="n in workspace.blacklistedNodes"\n      class="kuiFieldGroup"\n    >\n      <div class="kuiFieldGroupSection">\n        <button\n          class="kuiButton kuiButton--hollow"\n          ng-click="workspace.unblacklist(n)"\n        >\n          <span class="kuiIcon fa-times"></span>\n        </button>\n      </div>\n\n      <div class="kuiFieldGroupSection kuiFieldGroupSection--wide">\n        <p class="kuiText">\n          {{n.label}}\n        </p>\n      </div>\n    </div>\n    \x3c!-- ====== stop terms ====== --\x3e\n  </div>\n\n  <button\n    type="button"\n    class="kuiButton kuiButton--danger kuiButton--iconText kuiVerticalRhythm"\n    ng-click="workspace.blacklistedNodes=[]"\n    ng-disabled="workspace.blacklistedNodes.length === 0"\n  >\n    <span class="kuiButton__icon kuiIcon fa-trash"></span>\n    <span\n      i18n-id="xpack.graph.settings.blacklist.clearButtonLabel"\n      i18n-default-message="Clear"\n    ></span>\n  </button>\n</div>\n\x3c!-- ====== end term blacklist tab content ====== --\x3e\n\n\n\x3c!-- ====== start drilldowns tab content ====== --\x3e\n<div\n  ng-if="configPanel===\'drillDowns\'"\n  class="list-group-item list-group-item--noBorder"\n>\n\n  \x3c!-- ====== start add form ====== --\x3e\n  <form ng-submit="saveUrlTemplate()" role="form" class="form-horizontal">\n\n    \x3c!-- ====== start url ====== --\x3e\n    <div class="form-group">\n      <div class="col-sm-1 control-label">\n        <label\n          for="urlTemplateUrl"\n          i18n-id="xpack.graph.settings.drillDowns.urlInputLabel"\n          i18n-default-message="URL"\n        ></label>\n      </div>\n      <div class="col-sm-11">\n        <input\n          id="urlTemplateUrl"\n          ng-change="checkForKibanaUrl()"\n          ng-paste="handleUrlTemplatePaste($event)"\n          autocomplete="off"\n          type="text"\n          ng-model="newUrlTemplate.url"\n          placeholder="{{\'https://www.google.co.uk/#q={\' + \'{gquery}\' + \'}\' }}"\n          class="form-control col-sm-12"\n        >\n\n        <span ng-if="suggestTemplateFix">\n          <i\n            tooltip="{{ ::\'xpack.graph.settings.drillDowns.kibanaUrlWarningTooltip\' | i18n: { defaultMessage: \'Kibana URL pasted\' } }}"\n            class="text-color-warning fa fa-warning"\n          ></i>\n          {{ ::\'xpack.graph.settings.drillDowns.kibanaUrlWarningText\' | i18n: { defaultMessage: \'This looks like a Kibana URL. Would you like us to convert it to a template for you?\' } }}\n          <a\n            ng-click="replaceKibanaUrlParam()"\n            i18n-id="xpack.graph.settings.drillDowns.kibanaUrlWarningYesOptionLinkText"\n            i18n-default-message="yes"\n          ></a> / <a\n            ng-click="rejectKibanaUrlSuggestion()"\n            i18n-id="xpack.graph.settings.drillDowns.kibanaUrlWarningNoOptionLinkText"\n            i18n-default-message="no"\n          ></a>\n        </span>\n\n        <p\n          class="help-block"\n          ng-non-bindable\n          i18n-id="xpack.graph.settings.drillDowns.urlInputHelpText"\n          i18n-default-message="Define template URLs using {gquery} where the selected vertex terms are inserted"\n          i18n-values="{ gquery: \'{{gquery}}\' }"\n        ></p>\n      </div>\n    </div>\n    \x3c!-- ====== stop url ====== --\x3e\n\n    \x3c!-- ====== start title ====== --\x3e\n    <div class="form-group">\n      <div class="col-sm-1 control-label">\n        <label\n          for="urlDescription"\n          i18n-id="xpack.graph.settings.drillDowns.urlDescriptionInputLabel"\n          i18n-default-message="Title"\n        ></label>\n      </div>\n      <div class="col-sm-5">\n        <input\n          id="urlDescription"\n          type="text"\n          autocomplete="off"\n          ng-model="newUrlTemplate.description"\n          placeholder="{{ :: \'xpack.graph.settings.drillDowns.urlDescriptionInputPlaceholder\' | i18n: { defaultMessage: \'Search on Google\' } }}"\n          class="form-control"\n        >\n      </div>\n      <div class="col-sm-2 control-label">\n        <label\n          for="encoder"\n          i18n-id="xpack.graph.settings.drillDowns.urlEncoderInputLabel"\n          i18n-default-message="URL parameter type"\n        ></label>\n      </div>\n      <div class="col-sm-4">\n        <select\n          class="form-control"\n          name="encoder"\n          ng-options="option.title for option in outlinkEncoders"\n          ng-model="newUrlTemplate.encoder">\n        </select>\n        <p class="help-block">{{newUrlTemplate.encoder.description}}</p>\n      </div>\n    </div>\n    \x3c!-- ====== stop title ====== --\x3e\n\n    \x3c!-- ====== start icon ====== --\x3e\n    <div class="form-group">\n      <div class="col-sm-1 control-label">\n        <label\n          for="encoder"\n          i18n-id="xpack.graph.settings.drillDowns.toolbarIconPickerLabel"\n          i18n-default-message="Toolbar icon"\n        ></label>\n      </div>\n\n      <div class="col-sm-9">\n        <span class="gphIconPicker">\n          <i\n            ng-repeat="i in drillDownIconChoices"\n            ng-click="toggleDrillDownIcon(newUrlTemplate,i)"\n            ng-class="{selectedNode:i==newUrlTemplate.icon}"\n            class="fa gphIconPicker__icon gphNoUserSelect"\n            ng-bind="i.code"\n          ></i>\n        </span>\n      </div>\n\n      <div class="col-sm-2">\n        <div class="pull-right kuiButtonGroup">\n          <button\n            type="reset"\n            ng-disabled="!newUrlTemplate.url&&!newUrlTemplate.description&&!newUrlTemplate.icon"\n            class="kuiButton kuiButton--basic"\n            ng-click="resetNewUrlTemplate()"\n            i18n-id="xpack.graph.settings.drillDowns.resetButtonLabel"\n            i18n-default-message="Reset"\n          ></button>\n\n          <button\n            type="submit"\n            ng-disabled="!newUrlTemplate.url||!newUrlTemplate.description"\n            class="kuiButton kuiButton--primary"\n            aria-label="{{ ::\'xpack.graph.settings.drillDowns.resetButtonAriaLabel\' | i18n: { defaultMessage: \'Save drill-down\' } }}"\n            i18n-id="xpack.graph.settings.drillDowns.saveButtonLabel"\n            i18n-default-message="Save"\n          ></button>\n        </div>\n      </div>\n    </div>\n    \x3c!-- ====== stop icon ====== --\x3e\n\n  </form>\n  \x3c!-- ====== stop add form ====== --\x3e\n\n  \x3c!-- ====== start list ====== --\x3e\n  <div class="gphDrilldownList">\n    <ul  class="list-group">\n      <li class="gphDrilldownList__item list-group-item" ng-repeat="urlTemplate in urlTemplates">\n        <i\n          ng-if="urlTemplate.icon"\n          class="fa icon gphNoUserSelect"\n        >\n          {{urlTemplate.icon.code}}\n        </i>\n\n        {{urlTemplate.description}}\n\n        <span class="pull-right">\n          <button\n            ng-click="editUrlTemplate(urlTemplate)"\n            class="kuiButton kuiButton--basic kuiButton--iconText kuiButton--small"\n            aria-label="{{ ::\'xpack.graph.settings.drillDowns.editButtonAriaLabel\' | i18n: { defaultMessage: \'Edit\' } }}"\n          >\n            <span aria-hidden="true" class="kuiIcon fa-pencil"></span>\n          </button>\n\n          <button\n            ng-click="removeUrlTemplate(urlTemplate)"\n            class="kuiButton kuiButton--danger kuiButton--iconText kuiButton--small"\n            aria-label="{{ ::\'xpack.graph.settings.drillDowns.removeButtonAriaLabel\' | i18n: { defaultMessage: \'Remove\' } }}"\n          >\n            <span aria-hidden="true" class="kuiIcon fa-trash"></span>\n          </button>\n        </span>\n      </li>\n    </ul>\n  </div>\n  \x3c!-- ====== stop list ====== --\x3e\n\n</div>\n\x3c!-- ====== end drilldowns tab content ====== --\x3e\n\n\n\x3c!-- ====== begin explore settings tab content ====== --\x3e\n<div\n  class="list-group-item list-group-item--noBorder"\n  ng-if="(selectedIndex !== null) && (configPanel === \'settings\')"\n>\n  <form class="form-horizontal">\n    <div class="form-group form-group-sm gphFormGroup--small">\n      <label\n        for="qIndexSampleSize"\n        class="col-sm-4 control-label"\n        i18n-id="xpack.graph.settings.advancedSettings.sampleSizeInputLabel"\n        i18n-default-message="Sample size"\n      ></label>\n\n      <div class="col-sm-6">\n        <input\n          type="number"\n          class="form-control input-sm"\n          min="1"\n          max="500000"\n          id="qIndexSampleSize"\n          ng-model="exploreControls.sampleSize"\n        >\n\n        <div\n          class="help-block"\n          i18n-id="xpack.graph.settings.advancedSettings.sampleSizeInputHelpText"\n          i18n-default-message="Terms are identified from samples of the most relevant documents. Bigger is not necessarily better - can be slower and less relevant."\n        ></div>\n      </div>\n    </div>\n\n    <div class="form-group">\n      <div class="col-sm-offset-4 col-sm-8">\n        <div class="checkbox">\n          <label>\n            <input\n              type="checkbox"\n              id="isSignifChk2"\n              ng-model="exploreControls.useSignificance"\n            >\n            {{ ::\'xpack.graph.settings.advancedSettings.significantLinksCheckboxLabel\' | i18n: { defaultMessage: \'Significant links\' } }}\n          </label>\n        </div>\n\n        <span\n          class="help-block"\n          i18n-id="xpack.graph.settings.advancedSettings.significantLinksCheckboxHelpText"\n          i18n-default-message="Identify terms that are &quot;significant&quot; rather than simply popular"\n        ></span>\n      </div>\n    </div>\n\n    <div class="form-group form-group-sm gphFormGroup--small">\n      <label\n        for="minDocCount"\n        class="col-sm-4 control-label"\n        i18n-id="xpack.graph.settings.advancedSettings.certaintyInputLabel"\n        i18n-default-message="Certainty"\n      ></label>\n      <div class="col-sm-6">\n        <input\n          type="number"\n          class="form-control input-sm"\n          min="1"\n          max="500000"\n          step="1"\n          id="minDocCount"\n          ng-model="exploreControls.minDocCount"\n        >\n\n        <div\n          class="help-block"\n          i18n-id="xpack.graph.settings.advancedSettings.certaintyInputHelpText"\n          i18n-default-message="The min number of documents that are required as evidence before introducing a related term"\n        ></div>\n      </div>\n    </div>\n\n    <div class="form-group form-group-sm gphFormGroup--small">\n      <label\n        for="qDiversityField"\n        class="col-sm-4 control-label"\n        i18n-id="xpack.graph.settings.advancedSettings.diversityFieldInputLabel"\n        i18n-default-message="Diversity field"\n      ></label>\n\n      <div class="col-sm-6">\n        <select\n          name="qDiversityField"\n          id="qDiversityField"\n          ng-options="field.name for field in allFields"\n          ng-model="exploreControls.sampleDiversityField"\n        >\n          <option\n            value=""\n            i18n-id="xpack.graph.settings.advancedSettings.diversityFieldInputOptionLabel"\n            i18n-default-message="[No diversification]"\n          ></option>\n        </select>\n\n        <span class="help-block">\n          {{ ::\'xpack.graph.settings.advancedSettings.diversityFieldInputHelpText1\' | i18n: { defaultMessage: \'To avoid document samples being dominated by a single voice, pick the field that helps identify the source of bias.\' } }}\n          <em>{{ ::\'xpack.graph.settings.advancedSettings.diversityFieldInputHelpText2\' | i18n: { defaultMessage: \'This must be a single-term field or searches will be rejected with an error\' } }}</em>\n        </span>\n      </div>\n    </div>\n\n    <div\n      class="form-group form-group-sm gphFormGroup--small"\n      ng-show="exploreControls.sampleDiversityField"\n    >\n      <label\n        for="qMaxValuesPerDoc"\n        class="col-sm-4 control-label"\n        i18n-id="xpack.graph.settings.advancedSettings.maxValuesInputLabel"\n        i18n-default-message="Max docs per field"\n      ></label>\n\n      <div class="col-sm-6">\n        <input\n          type="number"\n          class="form-control input-sm"\n          min="1"\n          max="500000"\n          step="1"\n          id="qMaxValuesPerDoc"\n          ng-model="exploreControls.maxValuesPerDoc"\n        >\n\n        <span class="help-block">\n          {{ ::\'xpack.graph.settings.advancedSettings.maxValuesInputHelpText\' | i18n: { defaultMessage: \'Max number of documents in a sample that can contain the same value for the\' } }}\n          <em>{{selectedDiversityField.name}}</em> {{ ::\'xpack.graph.settings.advancedSettings.maxValuesInputHelpText.fieldText\' | i18n: { defaultMessage: \'field\' } }}\n        </span>\n      </div>\n    </div>\n\n    <div class="form-group form-group-sm gphFormGroup--small">\n      <label\n        for="qTimeoutMillis"\n        class="col-sm-4 control-label"\n        i18n-id="xpack.graph.settings.advancedSettings.timeoutInputLabel"\n        i18n-default-message="Timeout (ms)"\n      ></label>\n\n      <div class="col-sm-6">\n        <input\n          type="number"\n          class="form-control input-sm"\n          min="1"\n          max="500000"\n          step="1"\n          id="qTimeoutMillis"\n          ng-model="exploreControls.timeoutMillis"\n        >\n\n        <span\n          class="help-block"\n          i18n-id="xpack.graph.settings.advancedSettings.timeoutInputHelpText"\n          i18n-default-message="Max time in milliseconds a request can run"\n        ></span>\n      </div>\n    </div>\n  </form>\n</div>\n\x3c!-- ====== end explore settings tab content ====== --\x3e\n'},9:function(module,exports){module.exports=vendors}});